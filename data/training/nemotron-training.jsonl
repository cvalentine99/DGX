{"id":"tshark_field_extraction_0049","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show TLS SNI sorted by frequency."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For ports, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_slow_database_0046","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Our MySQL response times have degraded. What do the metrics show?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      468\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_limitation_explanation_0154","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_dns_analysis_0032","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DNS query patterns for the last 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      578\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0038","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DNS anomalies or suspicious queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      939\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0090","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Count occurrences of each unique ports."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"negative_ethical_boundary_0148","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"cyberchef_decode_0047","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode multiple layers of encoding."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0017","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a TLS security audit on our mail servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      214\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0092","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show conversations to external IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0011","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check overall network connection health."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      862\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0075","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve files from this disk image."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"networkminer_extraction_0081","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify all hosts and their operating systems."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0027","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show smb traffic in the last first 5 minutes of the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0004","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 503 errors on the payment-api. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      835\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0023","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Parse this JSON structure."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"foremost_carving_0091","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"negative_tool_recommendation_0241","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"extrahop_http_errors_0010","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Break down HTTP errors by URI for auth-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      118\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0034","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode this HTML entities encoded string."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0040","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check NFS latency on NetApp-01."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      489\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0019","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare read vs write throughput on our NAS."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      852\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0098","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the file for known malware signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"capinfos_metadata_0051","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Calculate the packets per second rate."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0012","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Network seems slow. Check for congestion indicators."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      227\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0014","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"negative_out_of_scope_0129","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"extrahop_threat_detection_0096","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for outbound connections to malicious hosts."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      322\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0010","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Is the Redis slowdown caused by the application or network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      755\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0042","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      384\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0009","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of malware activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0085","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the attack timeline from this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"negative_terminology_correction_0013","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"tshark_conversation_analysis_0000","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the longest-running TCP sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0069","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for ransomware indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"negative_out_of_scope_0182","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"networkminer_extraction_0031","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract SSL certificates from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"binwalk_firmware_0092","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract kernel and rootfs."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0051","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan extracted files for malicious content."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"foremost_carving_0050","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve all recognizable files."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0060","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      916\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0059","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify conversations with high packet rates."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0016","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      843\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0076","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any LDAP authentication failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      590\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0035","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Calculate the packets per second rate."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0003","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate lateral movement in this traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"multi_tool_malware_workflow_0082","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform a full forensic analysis of the traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"yara_malware_scan_0066","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if this binary matches any YARA rules."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0089","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify LDAP performance issues."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      782\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0053","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0014","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Deobfuscate this PowerShell payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"negative_ethical_boundary_0021","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"xplico_reconstruction_0069","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all POST data from HTTP traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"negative_terminology_correction_0175","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"extrahop_dhcp_health_0040","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor lease renewals on the corporate VLAN."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      704\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0045","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration files."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0022","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all ftp conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For smtp, I'll use the filter 'smtp' or more specific filters like 'smtp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0010","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor Active Directory authentication metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      939\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0088","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify all hosts and their operating systems."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"volatility_memory_0090","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0082","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze command and control activity."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_storage_ops_0042","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check storage I/O patterns for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      543\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0056","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How many active TCP connections do we have?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      925\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0012","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The PostgreSQL database is running slow. Is it the network or the server?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      588\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0039","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are there any storage errors or bottlenecks?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      57\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0064","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find flows with unusual port combinations."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0034","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show aggregate connection metrics for capacity planning."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      34\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0071","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for TCP flow stalls across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      621\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0057","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Export DNS queries to CSV format."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"negative_ethical_boundary_0164","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"extrahop_http_errors_0090","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We need to investigate HTTP errors on the api-gateway application."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      458\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0031","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the malware family for this sample."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"negative_out_of_scope_0066","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"extrahop_tcp_congestion_0023","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify zero window conditions on our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      38\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0082","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DHCP servers with high NAK rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      319\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0015","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Network seems slow. Check for congestion indicators."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      30\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0065","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode multiple layers of encoding."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For hex, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0006","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the pcap for known attack signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0045","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we experiencing packet loss between SEA and NYC?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      864\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0002","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify congestion hotspots in the cloud data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      535\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0012","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the attack timeline from this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_slow_database_0066","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The MySQL is dragging. Need to identify the bottleneck."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      163\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0066","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any SIP errors or call failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      939\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0085","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all downloaded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0057","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are there any storage errors or bottlenecks?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      260\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0035","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all dns conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0094","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How long is this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0091","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find ssh traffic between 192.168.1.100 and 1.1.1.1."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For telnet, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0013","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show UDP flows sorted by packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"capinfos_metadata_0090","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How many packets are in this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0074","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS requests to suspicious domains."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      969\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0008","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email communications from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"foremost_carving_0016","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve files from this disk image."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0027","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for authentication bottlenecks on our LDAP servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      733\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0066","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor NFS performance across our file servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      273\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0085","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware, extract files, and correlate with threat intel."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"xplico_reconstruction_0091","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct FTP file transfers."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"yara_malware_scan_0006","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify obfuscation techniques in the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"tshark_field_extraction_0075","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract DNS queries from packets to 8.8.8.8."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"cyberchef_decode_0017","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract strings from this encoded blob."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0096","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find malware families associated with ghi789...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_threat_detection_0013","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a threat intelligence check on our network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      352\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0077","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for ftp traffic larger than 10000 bytes."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For ldap, I'll use the filter 'ldap' or more specific filters like 'ldap.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"suricata_ids_scan_0050","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets triggering high-severity alerts."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0056","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if file hash is malicious."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"capinfos_metadata_0081","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the data rate of this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"negative_out_of_scope_0121","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"foremost_carving_0044","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover deleted files from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"otx_threat_lookup_0064","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find malware families associated with def456...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0093","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me storage throughput metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      263\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0070","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations involving 172.16.0.50."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"strings_extraction_0094","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration data from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"volatility_memory_0097","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0022","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify clients making excessive DNS queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      703\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0047","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the LDAP response time trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      883\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0078","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Parse this protobuf structure."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0080","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"tshark_field_extraction_0064","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS queries for smtp packets only."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For User-Agents, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"splunk_search_0060","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for IP address across all logs."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0082","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the read/write ratio on our NAS storage?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      659\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0073","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"extrahop_dhcp_health_0052","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check DHCP server health - are we seeing any NAK responses?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      471\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0004","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all strings from this binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0085","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect any exploit attempts in the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0009","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing high latency on the SQL Server server. What's causing it?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      8\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0022","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      28\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0020","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find injected code in processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0017","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the LDAP response time trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      675\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0022","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if https://phishing.site/login is in any threat feeds."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0031","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate lateral movement in this traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_http_errors_0039","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 401 errors on the auth-service. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      114\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0041","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve files from this disk image."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0088","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Execute the full forensic workflow on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"negative_out_of_scope_0116","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"cyberchef_decode_0087","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert this hex dump to ASCII."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For XOR, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"splunk_search_0004","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate events from IDS and Active Directory."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"volatility_memory_0096","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find registry hives in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0010","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if http://evil.com/malware is in any threat feeds."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0046","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this capture for malicious activity."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_http_errors_0006","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We need to investigate HTTP errors on the auth-service application."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      367\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0073","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for network congestion indicators across the data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      971\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0055","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform a full forensic analysis of the traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_ldap_auth_0071","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for brute force attempts against DC01."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      260\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0065","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find flows with unusual port combinations."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"strings_extraction_0008","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs in the executable."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0094","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find flows with unusual port combinations."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"strings_extraction_0084","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs in the executable."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0015","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find domain controllers with high auth failure rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      625\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0101","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"extrahop_threat_detection_0089","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify potential data exfiltration to suspicious destinations."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      230\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0005","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for self-signed certificates across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      269\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0040","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find command strings in the sample."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0039","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find unusual DNS query patterns that might indicate exfiltration."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      661\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0225","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"capinfos_metadata_0015","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the file size and packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"negative_limitation_explanation_0151","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"xplico_reconstruction_0005","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all web forms submitted in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"otx_threat_lookup_0086","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find OTX pulses mentioning evil.com."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0033","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are getting 503 errors when accessing payment-api."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      837\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0055","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract embedded documents."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"tshark_field_extraction_0004","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show IP addresses for smtp packets only."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"capinfos_metadata_0002","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the first and last packet timestamp?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0087","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      199\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0021","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract files from memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"binwalk_firmware_0082","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the bootloader."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"negative_out_of_scope_0199","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"extrahop_ldap_auth_0097","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the LDAP response time trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      437\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0021","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all POST data from HTTP traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_site_overview_0015","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check overall network connection health."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      333\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0047","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run comprehensive analysis and generate a report."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"binwalk_firmware_0075","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract kernel and rootfs."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0011","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any voice quality issues on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      997\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0036","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare network RTT vs server processing time for db-analytics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      721\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0056","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all POST data from HTTP traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_http_errors_0029","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We need to investigate HTTP errors on the order-service application."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      383\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0052","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare network RTT vs server processing time for db-cluster-node1."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      785\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0042","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover deleted files from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"yara_malware_scan_0023","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan extracted files for malicious content."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"networkminer_extraction_0077","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract SSL certificates from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0092","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the reputation of def456...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"strings_extraction_0091","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0041","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor RTP stream quality for active calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      235\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0028","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run malware classification on extracted files."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0003","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What DNS record types are being queried most frequently?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      595\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0097","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations with the most retransmissions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0043","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"extrahop_site_overview_0064","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Give me an overview of total TCP connections at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      545\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0092","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor total network throughput for the branch-east site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      573\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0034","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the network slowdown? Check retransmits and zero windows."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      824\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0066","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for cleartext credentials in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0033","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the pcap for known attack signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0010","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we experiencing packet loss between ORD and DC2?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      422\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0027","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs in the executable."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0010","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any SSL/TLS vulnerabilities on our infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      795\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0055","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct the user's browsing timeline."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"yara_malware_scan_0049","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if this binary matches any YARA rules."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0096","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform threat hunting on this network capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"foremost_carving_0030","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve all recognizable files."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0050","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware, extract files, and correlate with threat intel."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_dhcp_health_0042","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check DHCP server health - are we seeing any NAK responses?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      92\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0025","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode this ROT13 encoded string."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"capinfos_metadata_0086","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the capture statistics."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"capinfos_metadata_0055","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How long is this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0008","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"foremost_carving_0095","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract embedded documents."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0083","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find servers using weak ciphers in our environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      524\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0087","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations with the most retransmissions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0005","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check storage I/O patterns for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      396\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0043","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the current connection load across the network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      909\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0076","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for call setup delays on the Asterisk system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      332\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0063","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List unique DNS queries values in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"capinfos_metadata_0057","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Calculate the packets per second rate."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0061","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify potential data exfiltration to suspicious destinations."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      622\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0002","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0033","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the network slowdown? Check retransmits and zero windows."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      787\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0019","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find command strings in the sample."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"splunk_search_0022","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find anomalous login patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"splunk_search_0010","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all events from server-prod."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0099","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"tshark_field_extraction_0015","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets where HTTP hosts matches 192.168.*."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For ports, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"capinfos_metadata_0065","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0013","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify LDAP performance issues."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      818\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0020","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform post-incident forensic analysis."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"tshark_conversation_analysis_0069","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations with the most retransmissions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0046","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract https packets from port 3389."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For ldap, I'll use the filter 'ldap' or more specific filters like 'ldap.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0062","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find unusual DNS query patterns that might indicate exfiltration."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      589\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0083","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all IP addresses from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"networkminer_extraction_0008","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for sensitive data in cleartext."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0044","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract chat messages from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"multi_tool_incident_response_0046","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the scope of the compromise."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_ssl_audit_0079","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me servers with weak cipher suites."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      372\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0098","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      218\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0022","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0016","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Execute the full forensic workflow on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"cyberchef_decode_0058","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode this URL encoded string."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For hex, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0081","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract VoIP call audio."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"binwalk_firmware_0070","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded certificates in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0026","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find servers using weak ciphers in our environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      238\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0073","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden images in the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0092","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify zero window conditions on our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      51\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0084","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for C2 communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      982\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0083","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check LDAP server health for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      935\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0099","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate events from IDS and DNS."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0089","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing high latency on the MySQL server. What's causing it?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      879\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0073","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the current connection load across the network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      322\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0001","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 1.2.3.4."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0007","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor total network throughput for the DC2 site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      643\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0095","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform threat hunting on this network capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_ldap_auth_0040","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the LDAP response time trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      331\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0072","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any servers still using TLS 1.0 or 1.1."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      921\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0049","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover files from slack space."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_voip_quality_0023","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the call failure rate in the last 6 hours?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      706\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0016","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Rebuild web browsing sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0099","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DHCP transaction metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      985\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0026","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check overall network connection health."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      522\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0055","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration files."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0099","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are complaining about slow Redis performance in the last 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      697\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_limitation_explanation_0202","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"capinfos_metadata_0005","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the file size and packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0066","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find malware families associated with ghi789...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0186","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"extrahop_site_overview_0093","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      239\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0009","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for http errors or anomalies."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For https, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0019","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find servers using weak ciphers in our environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      223\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0018","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"suricata_ids_scan_0045","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0067","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract SSL certificates from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0039","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare network RTT vs server processing time for db-master."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      402\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0064","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How many packets are in this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0015","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Rebuild downloaded web pages."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0009","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reverse the encoding on this payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For HTML entities, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0047","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which servers have certificate issues in the last 7 days?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      419\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0063","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all rdp conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For https, I'll use the filter 'https' or more specific filters like 'https.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"volatility_memory_0062","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find injected code in processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"tshark_field_extraction_0087","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all URLs from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"suricata_ids_scan_0023","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets triggering high-severity alerts."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"tshark_field_extraction_0001","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show ports sorted by frequency."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"negative_ethical_boundary_0019","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"negative_tool_recommendation_0025","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"negative_limitation_explanation_0244","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_ldap_auth_0061","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the LDAP response time trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      119\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0038","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform incident response analysis on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"tshark_protocol_filter_0058","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract kerberos packets from port 445."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For ssh, I'll use the filter 'ssh' or more specific filters like 'ssh.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0016","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Network seems slow. Check for congestion indicators."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      904\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0033","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor bind operation latency on our directory servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      172\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0077","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for unusual connection patterns at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      871\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0092","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare read vs write throughput on our NAS."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      89\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0071","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find network connections in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0059","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which DNS response codes are we seeing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      268\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0041","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are any devices communicating with suspicious external IPs?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      733\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0032","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract embedded documents."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"suricata_ids_scan_0040","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect any exploit attempts in the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"cyberchef_decode_0059","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this data using DES."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"foremost_carving_0099","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve files from this disk image."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"networkminer_extraction_0073","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for cleartext credentials in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"foremost_carving_0015","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"xplico_reconstruction_0054","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Rebuild web browsing sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_storage_ops_0099","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze file server workload distribution."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      351\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0098","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the time range of this pcap?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0075","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify conversations with high packet rates."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"foremost_carving_0048","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract archives from the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"capinfos_metadata_0048","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0041","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      258\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0080","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"binwalk_firmware_0089","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0012","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for call setup delays on the Zoom Phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      591\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0066","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0013","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze DNS traffic to identify potential tunneling."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      742\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0004","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      647\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0083","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode this XOR encoded string."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For XOR, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0040","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Mimikatz indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0026","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this data using XOR."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0033","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze DNS traffic to identify potential tunneling."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      413\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0055","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract SSL certificates from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"volatility_memory_0036","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all processes in the memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0098","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      199\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0050","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform post-incident forensic analysis."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"multi_tool_malware_workflow_0083","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a complete malware analysis on this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"cyberchef_decode_0082","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode this HTML entities encoded string."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0083","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for RAT indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0058","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find traffic to known bad IPs across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      815\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0032","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware, extract files, and correlate with threat intel."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"negative_ethical_boundary_0133","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"extrahop_tcp_congestion_0053","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the network slowdown? Check retransmits and zero windows."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      335\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0188","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"negative_ethical_boundary_0161","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"foremost_carving_0028","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract archives from the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_slow_database_0071","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The MySQL is dragging. Need to identify the bottleneck."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      458\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0024","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      15\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0043","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover deleted files from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"yara_malware_scan_0039","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0002","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit certificate expiration across the staging environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      199\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0006","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert this hex dump to ASCII."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0054","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify potential data exfiltration to suspicious destinations."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      865\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0075","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which DNS response codes are we seeing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      711\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_limitation_explanation_0207","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_dns_analysis_0011","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DNS anomalies or suspicious queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      65\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0060","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which DNS response codes are we seeing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      691\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0031","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover deleted files from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0039","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the longest-running TCP sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"strings_extraction_0095","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract registry keys from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0079","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Pull database performance metrics for the past 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      475\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0011","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor bind operation latency on our directory servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      962\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0068","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me LDAP error rates across our domain controllers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      324\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0094","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract SSL certificates from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_http_errors_0000","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the error rate on our web servers for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      23\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0066","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Break down HTTP errors by URI for payment-api."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      444\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0014","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      690\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0060","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check storage I/O patterns for the past 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      69\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0025","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      959\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0001","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The SQL Server is dragging. Need to identify the bottleneck."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      314\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0074","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the encryption health of our web servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      319\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0023","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      278\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0024","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the bootloader."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0074","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all downloaded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0093","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all files transferred in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"negative_out_of_scope_0132","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"extrahop_storage_ops_0087","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check storage I/O patterns for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      870\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0078","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"suricata_ids_scan_0055","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect any exploit attempts in the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"volatility_memory_0075","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find network connections in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0076","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets matching malware rules."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0020","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the malware family for this sample."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"strings_extraction_0067","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0005","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the attack timeline from this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"capinfos_metadata_0007","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How long is this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0084","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_http_errors_0070","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which API endpoints are failing on web-frontend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      230\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0007","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0015","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      857\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0025","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show conversations to external IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0012","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"yara_malware_scan_0033","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run malware classification on extracted files."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0033","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check this pcap for threats and extract IOCs."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"negative_out_of_scope_0105","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"extrahop_voip_quality_0090","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      165\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0040","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      893\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0031","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the time range of this pcap?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0073","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any SSL/TLS vulnerabilities on our infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      229\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0061","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How many active TCP connections do we have?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      670\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0033","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      8\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0077","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for network congestion indicators across the data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      },\n      {\n        \"name\": \"stall_out\"\n      }\n    ],\n    \"object_ids\": [\n      261\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0056","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for cleartext credentials in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0086","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the attack timeline from this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"networkminer_extraction_0095","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract SSL certificates from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"strings_extraction_0077","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0047","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for network congestion indicators across the data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      782\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0078","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor inbound vs outbound connection ratios."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      525\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0005","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0032","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check LDAP server health for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      514\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0004","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this firmware image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0051","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor total network throughput for the branch-east site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      811\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0075","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"negative_terminology_correction_0110","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"extrahop_storage_ops_0021","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze file server workload distribution."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      805\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0015","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"negative_limitation_explanation_0086","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"tshark_conversation_analysis_0009","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations involving 8.8.8.8."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0042","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the Snort Community ruleset against this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0083","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with high retransmission rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      542\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0068","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"binwalk_firmware_0094","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this firmware image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0007","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are there any storage errors or bottlenecks?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      993\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0022","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DHCP servers with high NAK rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      235\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0098","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for trojan indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0027","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Network seems slow. Check for congestion indicators."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      929\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0052","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Rebuild web browsing sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"volatility_memory_0053","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"networkminer_extraction_0032","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all HTTP file downloads."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"binwalk_firmware_0020","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded certificates in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0021","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor inbound vs outbound connection ratios."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      949\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0026","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the scope of the compromise."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"splunk_search_0032","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for registry events in the last 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"binwalk_firmware_0031","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the bootloader."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"foremost_carving_0046","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve all recognizable files."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0035","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show conversations to external IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0071","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any SIP errors or call failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      136\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0074","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for kerberos errors or anomalies."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"suricata_ids_scan_0026","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect command and control traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"volatility_memory_0005","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find registry hives in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0009","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      788\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0074","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for encoded or encrypted strings."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0008","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the encryption health of our web servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      798\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0092","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for C2 communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      367\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0027","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect command and control traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0021","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check LDAP server health for the past 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      597\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0029","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Pull database performance metrics for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      763\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0081","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show rdp traffic in the last middle section of the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For kerberos, I'll use the filter 'kerberos' or more specific filters like 'kerberos.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"otx_threat_lookup_0087","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if suspicious IP is malicious."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0036","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all TCP conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"foremost_carving_0098","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden images in the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0060","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for authentication bottlenecks on our LDAP servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      214\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0030","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How many active TCP connections do we have?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      585\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0019","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 1.2.3.4."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0042","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for NXDOMAIN spikes in the last 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      48\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0008","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare network RTT vs server processing time for db-replica-02."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      139\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0004","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DNS query distribution across our network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      674\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0072","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How many active TCP connections do we have?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      911\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0069","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate data exfiltration in this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"tshark_field_extraction_0018","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all URLs from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For IP addresses, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0007","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for network congestion indicators across the data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      865\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0008","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me LDAP error rates across our domain controllers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      551\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0044","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DNS anomalies or suspicious queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      801\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0069","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract kernel and rootfs."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"cyberchef_decode_0028","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decompress this gzip data."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"binwalk_firmware_0047","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0085","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"cyberchef_decode_0094","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert this hex dump to ASCII."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For HTML entities, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0016","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 192.168.1.1."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"foremost_carving_0094","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve all recognizable files."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0038","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check this pcap for threats and extract IOCs."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"tshark_field_extraction_0065","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract User-Agents from packets to 8.8.8.8."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For ports, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"capinfos_metadata_0068","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the first and last packet timestamp?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0011","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform incident response analysis on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"tshark_protocol_filter_0028","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract ssh packets from port 443."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For smtp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"capinfos_metadata_0033","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the capture statistics."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0057","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all web forms submitted in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0017","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor lease renewals on the IoT VLAN."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      851\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0066","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter the pcap to show only smtp packets."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For icmp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"negative_tool_recommendation_0183","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"yara_malware_scan_0073","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify obfuscation techniques in the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"capinfos_metadata_0001","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the file size and packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0094","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      304\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0062","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify all hosts and their operating systems."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_http_errors_0071","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which API endpoints are failing on web-frontend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      365\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0012","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DNS anomalies or suspicious queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      763\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0085","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract command history."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"binwalk_firmware_0063","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract kernel and rootfs."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0149","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"multi_tool_malware_workflow_0014","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run comprehensive analysis and generate a report."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"negative_ethical_boundary_0156","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"yara_malware_scan_0072","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"tshark_field_extraction_0059","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract URLs and packet sizes together."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"splunk_search_0011","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find anomalous process execution patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"strings_extraction_0046","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for encoded or encrypted strings."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"binwalk_firmware_0009","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this firmware image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0044","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0093","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS requests to suspicious domains."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      146\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0092","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden images in the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0021","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform threat hunting on this network capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"tshark_field_extraction_0002","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find HTTP hosts values that appear only once."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"negative_ethical_boundary_0184","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"tshark_protocol_filter_0002","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract dns packets with specific flags."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For rdp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"negative_terminology_correction_0067","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_dns_analysis_0094","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find unusual DNS query patterns that might indicate exfiltration."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      84\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0091","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show conversations to external IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"yara_malware_scan_0008","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Empire indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"volatility_memory_0045","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify malicious processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0087","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract VoIP call audio."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_site_overview_0040","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      583\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0177","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"binwalk_firmware_0015","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0026","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the LDAP response time trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      600\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0036","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the first and last packet timestamp?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"binwalk_firmware_0088","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify compression algorithms used."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0079","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show aggregate connection metrics for capacity planning."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      193\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0067","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract embedded documents."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"negative_out_of_scope_0022","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"negative_out_of_scope_0135","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"suricata_ids_scan_0002","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets matching dos rules."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"volatility_memory_0099","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract browser history from memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0097","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find threat actors associated with file hash."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"strings_extraction_0068","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded file paths."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0030","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      745\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0096","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for lateral movement indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0024","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      114\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0002","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract SSL certificates from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0093","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any IP allocation problems."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      856\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0058","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate network and endpoint events."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"tshark_field_extraction_0043","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets where MAC addresses matches *admin*."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"otx_threat_lookup_0099","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find malware families associated with def456...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0046","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract chat messages from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"multi_tool_incident_response_0066","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate this potential breach."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"splunk_search_0094","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find events matching failed."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0013","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DHCP failures across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      153\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0011","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the bootloader."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0034","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Pull database performance metrics for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      474\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0020","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify zero window conditions on our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      516\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_limitation_explanation_0197","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_dhcp_health_0077","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DHCP transaction metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      968\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0068","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract archives from the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"negative_ethical_boundary_0026","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"negative_terminology_correction_0128","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"strings_extraction_0097","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0024","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations with the most retransmissions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0248","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"extrahop_ldap_auth_0086","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me LDAP error rates across our domain controllers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      182\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0027","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for IP address across all logs."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0078","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me servers with weak cipher suites."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      616\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0040","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify zero window conditions on our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      682\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0089","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify malicious processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0140","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"yara_malware_scan_0096","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for shellcode patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_site_overview_0088","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      393\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0040","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Deobfuscate this VBScript payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For ROT13, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0019","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DHCP success rate on our servers?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      877\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0058","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find HTTP hosts values that appear only once."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_storage_ops_0034","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the read/write ratio on our NAS storage?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      633\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0091","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      557\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0028","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the encryption health of our web servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      528\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0090","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract VoIP call audio."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0009","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the malware analysis pipeline."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_dhcp_health_0014","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DHCP success rate on our servers?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      647\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0051","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify conversations with high packet rates."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0038","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the top failing URIs on auth-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      494\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0004","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Execute the full forensic workflow on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_threat_detection_0012","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for C2 communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      747\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0008","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      173\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0078","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the file for known malware signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"suricata_ids_scan_0062","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets triggering high-severity alerts."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0067","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      275\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0013","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform a full forensic analysis of the traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"multi_tool_incident_response_0088","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_threat_detection_0076","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      993\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0051","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all POST data from HTTP traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"capinfos_metadata_0019","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0085","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations involving 192.168.1.100."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0057","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for unusual connection patterns at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      186\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0092","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the top failing URIs on user-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      377\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0031","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the ET Open ruleset against this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0022","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How many active TCP connections do we have?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      157\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0086","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find http traffic between 172.16.0.50 and 10.0.0.254."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For kerberos, I'll use the filter 'kerberos' or more specific filters like 'kerberos.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"extrahop_http_errors_0088","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the error rate on our web servers for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      793\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0059","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware, extract files, and correlate with threat intel."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"negative_tool_recommendation_0257","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"yara_malware_scan_0017","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for anti-analysis patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_site_overview_0048","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Give me an overview of total TCP connections at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      594\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0033","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for cleartext credentials in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0038","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for call setup delays on the Asterisk system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      457\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0070","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DHCP servers with high NAK rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      962\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0039","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      480\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0020","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show UDP flows sorted by packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0039","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for cryptominer indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0036","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor bind operation latency on our directory servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      230\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0032","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0083","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email attachments from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0016","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the incident and identify the attack vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"multi_tool_incident_response_0079","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform post-incident forensic analysis."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_slow_database_0063","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if the database latency is due to network issues or server processing."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      668\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0047","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for domain across all logs."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"splunk_search_0005","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of malware activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0090","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me LDAP error rates across our domain controllers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      936\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0078","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all web forms submitted in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"negative_terminology_correction_0250","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"cyberchef_decode_0081","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode multiple layers of encoding."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0027","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor inbound vs outbound connection ratios."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      518\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0006","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform post-incident forensic analysis."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"yara_malware_scan_0058","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for suspicious imports patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0079","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor bind operation latency on our directory servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      522\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0003","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which API endpoints are failing on api-gateway?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      920\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0046","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find network connections in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0089","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me storage throughput metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      527\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0097","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all POST data from HTTP traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_slow_database_0048","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The PostgreSQL is dragging. Need to identify the bottleneck."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      884\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0011","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      495\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0024","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0139","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_dns_analysis_0082","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find unusual DNS query patterns that might indicate exfiltration."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      6\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0061","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the scope of the compromise."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"capinfos_metadata_0062","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"tshark_field_extraction_0008","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show TLS SNI for http packets only."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_voip_quality_0069","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      816\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0037","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify all hosts and their operating systems."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0020","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the call failure rate in the last 6 hours?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      414\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0025","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a threat intelligence check on our network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      785\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0033","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0013","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"splunk_search_0007","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for exfiltration indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"binwalk_firmware_0027","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract the filesystem from the firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"negative_out_of_scope_0032","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"tshark_protocol_filter_0085","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show http traffic in the last last 10 minutes of the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0018","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for lateral movement patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0025","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check SIP transaction health across our VoIP infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      21\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0059","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any LDAP authentication failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      684\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0027","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me storage throughput metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      680\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0070","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the attack timeline from this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"foremost_carving_0024","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract archives from the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"tshark_protocol_filter_0089","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find kerberos traffic between 10.0.0.1 and 8.8.8.8."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For ftp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"otx_threat_lookup_0084","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for file hash."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0068","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform incident response analysis on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_dhcp_health_0000","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DHCP failures across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      794\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0083","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Break down HTTP errors by URI for user-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      497\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0009","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List loaded DLLs for each process."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"splunk_search_0088","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for domain across all logs."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0191","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"tshark_protocol_filter_0059","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract ldap packets with specific flags."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"xplico_reconstruction_0099","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract VoIP call audio."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0031","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DHCP failures across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      391\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0024","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform a full forensic analysis of the traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"volatility_memory_0051","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find injected code in processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0011","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for malicious domain."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"cyberchef_decode_0066","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Parse this protobuf structure."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0019","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a complete malware analysis on this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"otx_threat_lookup_0065","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up CVE information for CVE-2021-44228."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0043","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all rdp requests to api.service.local."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For smtp, I'll use the filter 'smtp' or more specific filters like 'smtp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"strings_extraction_0090","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find command strings in the sample."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"volatility_memory_0042","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify malicious processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0051","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The web-frontend is returning errors. Need to identify the problematic endpoints."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      532\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0044","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Execute the full forensic workflow on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_tcp_congestion_0063","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me TCP retransmissions in the last 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      },\n      {\n        \"name\": \"stall_out\"\n      }\n    ],\n    \"object_ids\": [\n      255\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0042","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0055","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor NFS performance across our file servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      781\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0047","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract browser history from memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0060","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any servers still using TLS 1.0 or 1.1."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      195\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0018","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      858\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0054","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are complaining about slow MariaDB performance in the last 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      582\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0005","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if file hash is malicious."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"splunk_search_0016","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate network and endpoint events."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0093","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the 503 responses on our web tier?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      834\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0013","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of breach activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"negative_out_of_scope_0231","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"extrahop_ldap_auth_0019","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for authentication bottlenecks on our LDAP servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      743\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0074","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we experiencing packet loss between ORD and SEA?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      },\n      {\n        \"name\": \"stall_out\"\n      }\n    ],\n    \"object_ids\": [\n      65\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0012","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_http_errors_0041","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the error rate on our web servers for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      259\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0216","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"extrahop_ldap_auth_0034","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for authentication bottlenecks on our LDAP servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      717\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0028","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect command and control traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0049","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we experiencing packet loss between DFW and LAX?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      702\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0084","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract archives from the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"negative_terminology_correction_0124","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"negative_out_of_scope_0094","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"capinfos_metadata_0009","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the capture statistics."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"tshark_field_extraction_0088","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract User-Agents and packet sizes together."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0019","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify clients making excessive DNS queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      894\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0088","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve files from this disk image."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_site_overview_0076","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      848\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0002","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform incident response analysis on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"strings_extraction_0024","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email addresses from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0065","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any LDAP authentication failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      2\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0079","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform threat hunting on this network capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"capinfos_metadata_0012","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the average packet size?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0002","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find domain controllers with high auth failure rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      705\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0065","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me any connections to suspicious hosts in the last 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      284\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0145","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_tcp_congestion_0057","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for TCP flow stalls across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      521\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0080","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit certificate expiration across the production environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      764\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0051","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"extrahop_http_errors_0055","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 403 errors on the user-service. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      1000\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0042","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find anomalous data transfer patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0253","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"otx_threat_lookup_0051","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find related indicators for IP."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"cyberchef_decode_0036","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decompress this gzip data."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0079","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all https requests to internal.corp."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For kerberos, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"yara_malware_scan_0057","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the malware family for this sample."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"tshark_protocol_filter_0019","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter the pcap to show only telnet packets."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For https, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"volatility_memory_0025","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"volatility_memory_0018","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0160","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"splunk_search_0045","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of breach activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0044","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the LDAP response time trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      81\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0014","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0091","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor DHCP lease activity for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      348\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0089","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the malware family for this sample."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"xplico_reconstruction_0011","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct the user's browsing timeline."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_threat_detection_0030","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      319\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0082","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor Active Directory authentication metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      325\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0028","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"binwalk_firmware_0067","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0099","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me TCP retransmissions in the last 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      605\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0069","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me storage throughput metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      537\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0025","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the file size and packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"negative_limitation_explanation_0259","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"multi_tool_incident_response_0010","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate data exfiltration in this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_http_errors_0053","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the 502 responses on our web tier?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      345\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0065","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract VoIP call audio."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"capinfos_metadata_0016","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How long is this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"negative_out_of_scope_0193","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"tshark_field_extraction_0047","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show TLS SNI for dns packets only."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"networkminer_extraction_0020","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0095","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Is the MongoDB slowdown caused by the application or network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      406\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0027","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reverse the encoding on this payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For Base64, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0048","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor Active Directory authentication metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      450\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0046","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for network congestion indicators across the data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      180\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0050","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode multiple layers of encoding."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0098","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the reputation of ghi789...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"cyberchef_decode_0092","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Deobfuscate this VBScript payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For hex, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0215","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_voip_quality_0005","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      649\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0010","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any voice quality issues on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      467\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0083","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for unusual connection patterns at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      256\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0061","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Count occurrences of each unique IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For IP addresses, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0006","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS requests to suspicious domains."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      664\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0064","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve all recognizable files."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_http_errors_0064","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the 403 responses on our web tier?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      959\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0053","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve files from this disk image."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"otx_threat_lookup_0048","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find malware families associated with ghi789...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0086","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email communications from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"volatility_memory_0016","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find network connections in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0086","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit certificate expiration across the development environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      287\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0039","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check SIP transaction health across our VoIP infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      316\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0050","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the file size and packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0097","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any SIP errors or call failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      618\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0036","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show aggregate connection metrics for capacity planning."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      286\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0232","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"multi_tool_incident_response_0057","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the scope of the compromise."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"xplico_reconstruction_0006","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct FTP file transfers."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"xplico_reconstruction_0025","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Rebuild downloaded web pages."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"volatility_memory_0055","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List loaded DLLs for each process."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0088","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing high latency on the SQL Server server. What's causing it?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      372\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0038","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find HTTP hosts values that appear only once."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For ports, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_threat_detection_0005","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify potential data exfiltration to suspicious destinations."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      391\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0029","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any IP allocation problems."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      456\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0082","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the longest-running TCP sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0063","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a TLS security audit on our mail servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      24\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0058","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the current connection load across the network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      755\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0058","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets matching malware rules."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0090","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me storage throughput metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      49\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0038","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"foremost_carving_0020","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve all recognizable files."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"suricata_ids_scan_0056","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0054","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DHCP transaction metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      996\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0021","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for network congestion indicators across the data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      484\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0077","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show suspicious network activity from the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      832\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_limitation_explanation_0211","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_slow_database_0091","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The Redis is dragging. Need to identify the bottleneck."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      558\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0004","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor call setup times for the past 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      395\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0017","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find related indicators for IP."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0068","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we experiencing packet loss between ORD and LAX?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      600\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0090","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the incident and identify the attack vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"capinfos_metadata_0066","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How many packets are in this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"negative_ethical_boundary_0239","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"extrahop_voip_quality_0014","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      810\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0041","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find command strings in the sample."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0037","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check storage I/O patterns for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      167\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0030","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract rdp packets from port 443."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0049","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor DHCP lease activity for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      973\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0040","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run comprehensive analysis and generate a report."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"multi_tool_incident_response_0042","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"yara_malware_scan_0088","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"negative_out_of_scope_0238","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"extrahop_dns_analysis_0087","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find unusual DNS query patterns that might indicate exfiltration."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      4\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0003","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all TCP conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"splunk_search_0085","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find anomalous login patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0020","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are there any storage errors or bottlenecks?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      96\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0070","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate events from IDS and Active Directory."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0027","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Execute the full forensic workflow on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"otx_threat_lookup_0028","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the reputation of ghi789...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"splunk_search_0052","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find failed login attempts from 192.168.1.50."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0040","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0049","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decompress this gzip data."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0038","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for anti-analysis patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_slow_database_0004","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare network RTT vs server processing time for db-analytics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      743\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0035","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the firmware structure."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0011","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect any exploit attempts in the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"negative_out_of_scope_0233","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"multi_tool_incident_response_0094","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_dns_analysis_0098","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DNS anomalies or suspicious queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      52\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0095","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration files."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0049","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"foremost_carving_0074","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve files from this disk image."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"splunk_search_0000","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for file events in the last 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0079","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are there any DHCP pool exhaustion issues?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      746\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0005","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract registry keys from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"negative_limitation_explanation_0167","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_voip_quality_0007","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor call setup times for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      830\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0050","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor RTP stream quality for active calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      481\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0056","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check LDAP server health for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      977\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0098","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      469\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0084","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are getting 401 errors when accessing user-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      211\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0074","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all URLs from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"negative_out_of_scope_0144","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"tshark_conversation_analysis_0023","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all unique IP pairs in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"networkminer_extraction_0070","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract SSL certificates from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"volatility_memory_0092","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract browser history from memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0088","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show telnet traffic in the last middle section of the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For ftp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"negative_terminology_correction_0053","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"negative_terminology_correction_0159","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"capinfos_metadata_0022","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the capture statistics."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0060","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify potential data exfiltration to suspicious destinations."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      175\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0071","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract archives from the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"xplico_reconstruction_0083","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all web forms submitted in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_slow_database_0097","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Our SQL Server response times have degraded. What do the metrics show?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      178\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0023","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor inbound vs outbound connection ratios."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      376\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0015","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find injected code in processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0045","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"multi_tool_incident_response_0022","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate lateral movement in this traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"otx_threat_lookup_0025","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find threat actors associated with suspicious IP."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0010","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations involving 10.0.0.1."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0026","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"splunk_search_0023","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate network and endpoint events."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0053","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me storage throughput metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      970\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0057","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We need to investigate HTTP errors on the order-service application."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      980\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0057","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the pcap for known attack signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0075","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all ldap traffic from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For smtp, I'll use the filter 'smtp' or more specific filters like 'smtp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"extrahop_threat_detection_0001","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find traffic to known bad IPs across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      32\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0098","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all downloaded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"negative_out_of_scope_0106","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"yara_malware_scan_0004","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for encoded strings patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_storage_ops_0044","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check storage I/O patterns for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      465\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0210","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"foremost_carving_0004","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"otx_threat_lookup_0040","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up CVE information for CVE-2021-44228."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0041","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0006","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify zero window conditions on our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      },\n      {\n        \"name\": \"stall_out\"\n      }\n    ],\n    \"object_ids\": [\n      51\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0081","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform a full forensic analysis of the traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_storage_ops_0003","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      204\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0036","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all downloaded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0037","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any LDAP authentication failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      287\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_tool_recommendation_0029","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"extrahop_storage_ops_0052","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor NFS performance across our file servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      56\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0021","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for outbound connections to malicious hosts."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      566\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0039","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Execute the full forensic workflow on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"volatility_memory_0033","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract browser history from memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0000","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      392\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0071","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the encryption health of our web servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      530\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0088","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a threat intelligence check on our network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      476\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0037","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"volatility_memory_0029","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract browser history from memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0081","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check LDAP server health for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      735\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0077","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if this binary matches any YARA rules."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0086","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert from hex to binary."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"volatility_memory_0083","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract browser history from memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0006","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any IP allocation problems."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      511\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0007","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the scope of the compromise."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"tshark_field_extraction_0045","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS queries sorted by frequency."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0031","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which DNS response codes are we seeing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      77\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0073","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare read vs write throughput on our NAS."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      721\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0059","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve files from this disk image."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"negative_tool_recommendation_0088","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"capinfos_metadata_0072","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the data rate of this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"strings_extraction_0082","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email addresses from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0073","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all TCP conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"yara_malware_scan_0068","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Mimikatz indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"multi_tool_incident_response_0049","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform incident response analysis on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_http_errors_0068","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 504 errors on the auth-service. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      787\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0064","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Pull database performance metrics for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      38\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0023","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0065","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Execute the full forensic workflow on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"tshark_field_extraction_0092","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DNS queries values that appear only once."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For MAC addresses, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0042","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze and extract all artifacts from this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"tshark_field_extraction_0050","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find HTTP hosts values that appear only once."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"tshark_field_extraction_0098","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DNS queries values that appear only once."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"xplico_reconstruction_0041","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct the user's browsing timeline."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"binwalk_firmware_0034","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_field_extraction_0082","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all ports from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0076","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify clients making excessive DNS queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      162\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0097","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DHCP success rate on our servers?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      711\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0098","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for C2 communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      373\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0013","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze command and control activity."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_voip_quality_0072","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor RTP stream quality for active calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      572\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0018","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Give me an overview of total TCP connections at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      456\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0018","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode this XOR encoded string."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"negative_ethical_boundary_0274","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"suricata_ids_scan_0086","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0041","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract smb packets with specific flags."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For smb, I'll use the filter 'smb' or more specific filters like 'smb.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"foremost_carving_0087","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden images in the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0087","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me servers with weak cipher suites."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      52\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0083","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare network RTT vs server processing time for db-replica-02."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      132\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0020","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any LDAP authentication failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      327\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0083","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"multi_tool_malware_workflow_0071","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware, extract files, and correlate with threat intel."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_tcp_congestion_0084","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the edge segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      403\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0088","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DHCP failures across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      853\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0072","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for authentication events in the last 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0084","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor NFS performance across our file servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      231\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0087","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify zero window conditions on our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      299\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0035","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify all hosts and their operating systems."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0057","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for sensitive data in cleartext."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"cyberchef_decode_0011","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decompress this gzip data."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0088","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any SIP errors or call failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      699\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0044","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for suspicious IP."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0029","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      45\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0045","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover files from slack space."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0035","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      437\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0079","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Parse this protobuf structure."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For XOR, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0237","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"splunk_search_0056","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate events from endpoint and DNS."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"networkminer_extraction_0017","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all downloaded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0072","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets triggering high-severity alerts."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"volatility_memory_0041","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List loaded DLLs for each process."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0021","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze DNS traffic to identify potential tunneling."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      236\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0043","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Calculate the packets per second rate."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"cyberchef_decode_0044","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Parse this JSON structure."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"foremost_carving_0036","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract embedded documents."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0075","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me LDAP error rates across our domain controllers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      598\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0043","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the reputation of abc123...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0165","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"binwalk_firmware_0021","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0096","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show icmp traffic in the last middle section of the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"negative_limitation_explanation_0122","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"networkminer_extraction_0023","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for cleartext credentials in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0064","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show suspicious network activity from the past 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      959\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0093","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for botnet indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"volatility_memory_0054","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find injected code in processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0010","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run comprehensive analysis and generate a report."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"yara_malware_scan_0076","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for encoded strings patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"tshark_protocol_filter_0065","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract smtp packets with specific flags."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0015","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all http traffic from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For smb, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"extrahop_site_overview_0065","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      475\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0060","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the reputation of def456...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"yara_malware_scan_0062","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the malware family for this sample."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0051","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What DNS record types are being queried most frequently?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      532\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0069","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the file size and packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"volatility_memory_0074","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract command history."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0181","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"tshark_conversation_analysis_0072","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show conversations to external IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"tshark_field_extraction_0073","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show HTTP hosts sorted by frequency."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"splunk_search_0080","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find failed login attempts from external IP."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0052","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find domain controllers with high auth failure rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      687\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0048","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 403 errors on the auth-service. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      562\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0008","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations involving 8.8.8.8."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"binwalk_firmware_0091","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract the filesystem from the firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0053","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find flows with unusual port combinations."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0001","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for lateral movement patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"volatility_memory_0084","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract browser history from memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"tshark_field_extraction_0026","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all HTTP hosts from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_http_errors_0067","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the error rate on our web servers for the past 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      672\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0078","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor lease renewals on the corporate VLAN."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      813\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0020","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all rdp traffic from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For dns, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0021","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor lease renewals on the management VLAN."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      406\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0035","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert this hex dump to ASCII."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"strings_extraction_0047","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract registry keys from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0023","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"HTTP errors increased on the payment-api in the last 5 minutes. What's happening?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      937\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0032","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with high retransmission rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      },\n      {\n        \"name\": \"stall_out\"\n      }\n    ],\n    \"object_ids\": [\n      756\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0017","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find command strings in the sample."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"yara_malware_scan_0071","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run malware classification on extracted files."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_voip_quality_0063","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      729\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0032","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing high latency on the PostgreSQL server. What's causing it?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      959\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0057","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      663\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0070","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Rebuild web browsing sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"foremost_carving_0057","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_storage_ops_0077","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      154\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0003","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show HTTP hosts sorted by frequency."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_slow_database_0007","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if the database latency is due to network issues or server processing."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      447\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0021","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect any exploit attempts in the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0085","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any SIP errors or call failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      525\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0018","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The order-service is returning errors. Need to identify the problematic endpoints."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      769\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0047","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find flows with unusual port combinations."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"negative_out_of_scope_0224","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"yara_malware_scan_0064","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the YARA-Rules rules against this file."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"capinfos_metadata_0096","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the capture statistics."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"foremost_carving_0085","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden images in the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"splunk_search_0028","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find anomalous process execution patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"capinfos_metadata_0076","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Calculate the packets per second rate."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0040","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the quality of our VoIP calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      575\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0035","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find related indicators for hash."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0062","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Network seems slow. Check for congestion indicators."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      618\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0011","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0023","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_storage_ops_0004","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      77\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0026","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      805\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0173","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"capinfos_metadata_0039","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Calculate the packets per second rate."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0040","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract ftp packets from port 3389."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"extrahop_threat_detection_0099","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for outbound connections to malicious hosts."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      563\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0251","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"binwalk_firmware_0085","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify compression algorithms used."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0010","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show http traffic in the last last 10 minutes of the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For smtp, I'll use the filter 'smtp' or more specific filters like 'smtp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"capinfos_metadata_0046","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the first and last packet timestamp?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0038","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any IP allocation problems."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      205\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0070","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for call setup delays on the Zoom Phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      472\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0009","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for TCP flow stalls across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      430\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0014","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Export User-Agents to CSV format."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For HTTP hosts, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0005","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me TCP retransmissions in the last 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      211\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0020","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"negative_out_of_scope_0226","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"strings_extraction_0034","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all strings from this binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"binwalk_firmware_0074","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract kernel and rootfs."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"cyberchef_decode_0016","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reverse the encoding on this payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0073","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are any devices communicating with suspicious external IPs?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      822\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0088","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0053","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect any exploit attempts in the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"foremost_carving_0047","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract embedded documents."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_http_errors_0009","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The web-frontend is returning errors. Need to identify the problematic endpoints."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      920\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0017","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for NXDOMAIN spikes in the last 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      64\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0074","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform threat hunting on this network capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"otx_threat_lookup_0002","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if suspicious IP is malicious."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0050","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for NXDOMAIN spikes in the last 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      421\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0011","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find telnet traffic between 192.168.1.100 and 1.1.1.1."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For ftp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0005","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor Active Directory authentication metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      383\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0074","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate data exfiltration in this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"multi_tool_malware_workflow_0077","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze and extract all artifacts from this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"strings_extraction_0069","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract registry keys from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0085","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare network RTT vs server processing time for db-prod-01."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      254\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0016","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract ftp packets with specific flags."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For icmp, I'll use the filter 'icmp' or more specific filters like 'icmp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0057","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations with the most retransmissions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0087","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any voice quality issues on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      375\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0001","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me TCP retransmissions in the last 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      819\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0060","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate lateral movement in this traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_threat_detection_0044","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me any connections to suspicious hosts in the last 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      469\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0083","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate events from endpoint and proxy."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"volatility_memory_0065","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find injected code in processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0076","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are getting 504 errors when accessing order-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      635\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0043","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor RTP stream quality for active calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      440\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0070","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me storage throughput metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      204\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0061","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How long is this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0041","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check LDAP server health for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      791\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_limitation_explanation_0120","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"networkminer_extraction_0050","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email attachments from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0020","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are any devices communicating with suspicious external IPs?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      112\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0019","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets matching exploit rules."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0016","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find flows with unusual port combinations."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0028","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform threat hunting on this network capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"yara_malware_scan_0015","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the file for known malware signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"multi_tool_incident_response_0067","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform incident response analysis on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"yara_malware_scan_0047","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan extracted files for malicious content."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0005","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze DNS traffic to identify potential tunneling."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      166\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0035","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check this pcap for threats and extract IOCs."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"yara_malware_scan_0060","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the YARA-Rules rules against this file."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"yara_malware_scan_0091","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"capinfos_metadata_0003","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"foremost_carving_0089","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover files from slack space."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"suricata_ids_scan_0087","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"cyberchef_decode_0095","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decompress this gzip data."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0098","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate this potential breach."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"multi_tool_malware_workflow_0023","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Execute the full forensic workflow on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_http_errors_0077","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which API endpoints are failing on order-service?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      763\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0080","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all strings from this binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0093","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the scope of the compromise."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"splunk_search_0014","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of malware activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0024","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform incident response analysis on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"tshark_protocol_filter_0001","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for ldap errors or anomalies."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For http, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"binwalk_firmware_0066","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the firmware structure."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0058","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find malware families associated with def456...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0058","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      772\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0067","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze and extract all artifacts from this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_ssl_audit_0094","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me servers with weak cipher suites."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      210\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0056","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"xplico_reconstruction_0082","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all POST data from HTTP traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"splunk_search_0098","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for exfiltration indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0082","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"multi_tool_malware_workflow_0006","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze and extract all artifacts from this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"negative_terminology_correction_0195","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"negative_out_of_scope_0176","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"tshark_protocol_filter_0003","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract https packets with specific flags."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"splunk_search_0078","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all events from dc-primary."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0021","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 504 errors on the web-frontend. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      650\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0091","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode this Base64 encoded string."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0032","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the pcap for known attack signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"foremost_carving_0037","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract archives from the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0037","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for self-signed certificates across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      224\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0033","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets where MAC addresses matches *.exe."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"splunk_search_0077","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for brute force indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0037","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate data exfiltration in this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_tcp_congestion_0051","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me TCP retransmissions in the last 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      952\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0065","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find servers using weak ciphers in our environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      121\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0041","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate this potential breach."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"networkminer_extraction_0045","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for cleartext credentials in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0030","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract chat messages from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0096","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      620\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0003","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"strings_extraction_0051","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration data from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0023","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which DNS response codes are we seeing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      505\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0057","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find network connections in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0014","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if the database latency is due to network issues or server processing."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      423\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0060","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract files from memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"tshark_protocol_filter_0078","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find rdp traffic between 192.168.1.100 and 10.0.0.254."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For https, I'll use the filter 'https' or more specific filters like 'https.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0008","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What DNS record types are being queried most frequently?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      798\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0032","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      627\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0086","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all unique IP pairs in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0026","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing high latency on the PostgreSQL server. What's causing it?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      464\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0279","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"binwalk_firmware_0040","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract kernel and rootfs."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"cyberchef_decode_0072","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decompress this bzip2 data."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"tshark_field_extraction_0025","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets where HTTP hosts matches 192.168.*."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"otx_threat_lookup_0094","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if file hash is malicious."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0025","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets triggering high-severity alerts."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0086","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Empire indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_slow_database_0078","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The SQL Server database is running slow. Is it the network or the server?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      241\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0022","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover deleted files from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"xplico_reconstruction_0019","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"foremost_carving_0008","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover files from slack space."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0002","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reverse the encoding on this payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0078","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze file server workload distribution."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      890\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0028","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List loaded DLLs for each process."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"yara_malware_scan_0003","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if this binary matches any YARA rules."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0081","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DNS anomalies or suspicious queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      670\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0095","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any IP allocation problems."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      954\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0152","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"extrahop_threat_detection_0097","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me any connections to suspicious hosts in the last 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      694\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0095","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the file size and packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"foremost_carving_0023","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover exe files from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_http_errors_0056","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the 404 responses on our web tier?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      323\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0007","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DNS query patterns for the last 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      651\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0063","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for file hash."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"strings_extraction_0029","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find command strings in the sample."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0085","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the core segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      201\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0062","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all TCP conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0014","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate lateral movement in this traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_threat_detection_0063","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify potential data exfiltration to suspicious destinations."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      873\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0010","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract registry keys from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0076","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check DHCP server health - are we seeing any NAK responses?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      633\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0098","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for authentication bottlenecks on our LDAP servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      142\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0047","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for ldap errors or anomalies."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For ftp, I'll use the filter 'ftp' or more specific filters like 'ftp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"binwalk_firmware_0017","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract kernel and rootfs."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0039","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify LDAP performance issues."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      946\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0077","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract browser history from memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0084","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze and extract all artifacts from this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_voip_quality_0008","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the call failure rate in the last 6 hours?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      157\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0080","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0075","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the malware analysis pipeline."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"negative_ethical_boundary_0268","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"otx_threat_lookup_0089","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 1.2.3.4."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0016","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      337\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0097","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"extrahop_threat_detection_0053","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are any devices communicating with suspicious external IPs?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      556\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0067","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode multiple layers of encoding."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For Base64, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"negative_out_of_scope_0096","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"foremost_carving_0061","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover png files from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"foremost_carving_0058","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract files from memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_voip_quality_0047","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      919\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0079","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the firmware structure."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0031","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor RTP stream quality for active calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      475\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0075","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor NFS performance across our file servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      798\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0017","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"binwalk_firmware_0087","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded certificates in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0089","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DHCP success rate on our servers?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      341\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0036","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for call setup delays on the Cisco UCM system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      723\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0059","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"foremost_carving_0079","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve all recognizable files."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"yara_malware_scan_0065","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for anti-analysis patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"otx_threat_lookup_0062","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the reputation of abc123...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0072","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DNS query patterns for the last 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      813\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0046","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all User-Agents from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_site_overview_0063","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check overall network connection health."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      977\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0064","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor bind operation latency on our directory servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      704\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0087","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract smb packets from port 443."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"tshark_field_extraction_0054","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find HTTP hosts values that appear only once."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_voip_quality_0082","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      168\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0096","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for NXDOMAIN spikes in the last 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      378\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0041","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find malware families associated with abc123...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"volatility_memory_0003","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"foremost_carving_0013","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract files from memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_http_errors_0027","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"HTTP errors increased on the user-service in the last 15 minutes. What's happening?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      412\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0000","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Mimikatz indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"strings_extraction_0098","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs in the executable."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"capinfos_metadata_0026","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the data rate of this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"volatility_memory_0013","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0016","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any voice quality issues on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      493\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0041","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show URLs sorted by frequency."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For ports, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"strings_extraction_0066","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find command strings in the sample."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0021","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      616\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0059","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We need to investigate HTTP errors on the order-service application."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      330\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0090","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the longest-running TCP sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0089","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"strings_extraction_0045","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0069","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The MariaDB database is running slow. Is it the network or the server?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      334\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0021","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract User-Agents from packets to 8.8.8.8."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0003","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any servers still using TLS 1.0 or 1.1."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      753\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0067","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor lease renewals on the IoT VLAN."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      398\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0263","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"extrahop_threat_detection_0004","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me any connections to suspicious hosts in the last 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      232\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0094","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for encoded strings patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"tshark_field_extraction_0030","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Count occurrences of each unique User-Agents."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"foremost_carving_0010","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover files from slack space."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_voip_quality_0030","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      130\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0020","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How long is this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"capinfos_metadata_0070","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Calculate the packets per second rate."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0084","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Our MariaDB response times have degraded. What do the metrics show?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      655\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0065","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      723\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0001","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      261\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0002","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which API endpoints are failing on api-gateway?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      264\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0028","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      973\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0017","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform post-incident forensic analysis."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_storage_ops_0029","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the read/write ratio on our NAS storage?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      678\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0090","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find unusual DNS query patterns that might indicate exfiltration."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      555\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0054","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze and extract all artifacts from this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_dhcp_health_0064","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any IP allocation problems."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      635\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0054","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      565\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0050","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract VoIP call audio."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"negative_ethical_boundary_0255","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"splunk_search_0029","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate events from endpoint and DNS."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0011","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      708\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0031","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"HTTP errors increased on the api-gateway in the last 1 hour. What's happening?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      455\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0060","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Network seems slow. Check for congestion indicators."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      114\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0016","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS requests to suspicious domains."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      87\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0022","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Export HTTP hosts to CSV format."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For MAC addresses, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"negative_ethical_boundary_0243","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"extrahop_slow_database_0027","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Our Redis response times have degraded. What do the metrics show?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      502\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0074","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor bind operation latency on our directory servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      891\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0249","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_tcp_congestion_0017","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the backup segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      365\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0077","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any servers still using TLS 1.0 or 1.1."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      101\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0025","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all strings from this binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_threat_detection_0091","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify potential data exfiltration to suspicious destinations."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      724\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0084","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"otx_threat_lookup_0073","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 1.2.3.4."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0091","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for NXDOMAIN spikes in the last 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      12\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0072","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the firmware structure."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"negative_limitation_explanation_0266","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"tshark_field_extraction_0084","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract TLS SNI and TTL values together."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For DNS queries, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"capinfos_metadata_0083","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the data rate of this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0048","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with high retransmission rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      81\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0228","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"suricata_ids_scan_0054","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets matching exploit rules."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0067","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for C2 communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      612\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0004","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets matching policy rules."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0067","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify obfuscation techniques in the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"negative_ethical_boundary_0205","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"splunk_search_0033","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for hash across all logs."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0223","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"multi_tool_malware_workflow_0048","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the malware analysis pipeline."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_tcp_congestion_0028","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for TCP flow stalls across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      },\n      {\n        \"name\": \"stall_out\"\n      }\n    ],\n    \"object_ids\": [\n      220\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0069","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DHCP failures across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      349\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0039","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email communications from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"multi_tool_incident_response_0095","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the scope of the compromise."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_storage_ops_0002","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      971\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_limitation_explanation_0260","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"yara_malware_scan_0048","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the custom rules against this file."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_voip_quality_0083","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      17\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0023","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"tshark_field_extraction_0079","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract URLs and TTL values together."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"strings_extraction_0058","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs in the executable."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0017","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for call setup delays on the FreePBX system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      858\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0078","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find registry hives in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0073","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me LDAP error rates across our domain controllers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      287\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0275","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_tcp_congestion_0018","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the edge segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      },\n      {\n        \"name\": \"stall_out\"\n      }\n    ],\n    \"object_ids\": [\n      17\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0080","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve all recognizable files."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_http_errors_0075","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The user-service is returning errors. Need to identify the problematic endpoints."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      302\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0064","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_slow_database_0070","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are complaining about slow Cassandra performance in the last 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      367\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0047","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a threat intelligence check on our network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      149\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0083","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all telnet traffic from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For kerberos, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"otx_threat_lookup_0059","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if malicious domain is malicious."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0033","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations with the most retransmissions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"binwalk_firmware_0008","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract the filesystem from the firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"volatility_memory_0095","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List loaded DLLs for each process."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0071","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      135\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0075","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor call setup times for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      321\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0005","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode this Base64 encoded string."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0060","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any SIP errors or call failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      553\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0023","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate data exfiltration in this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_slow_database_0059","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if the database latency is due to network issues or server processing."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      950\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0058","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Our MySQL response times have degraded. What do the metrics show?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      998\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0096","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for brute force attempts against DC02."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      158\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0014","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"capinfos_metadata_0079","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0046","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the file for known malware signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0033","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Parse this MessagePack structure."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"volatility_memory_0063","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0065","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DNS query distribution across our network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      1\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0019","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for suspicious imports patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"xplico_reconstruction_0022","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract VoIP call audio."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"splunk_search_0065","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find failed login attempts from 10.0.0.100."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0078","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 8.8.8.8."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0027","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DHCP success rate on our servers?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      127\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0091","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware, extract files, and correlate with threat intel."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"networkminer_extraction_0041","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0077","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      840\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0020","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS requests to suspicious domains."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      236\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0039","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DHCP failures across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      65\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0010","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Empire indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_http_errors_0025","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are getting 404 errors when accessing api-gateway."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      3\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0049","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the custom ruleset against this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0095","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show conversations to external IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0077","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations with the most retransmissions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0039","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me servers with weak cipher suites."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      975\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0127","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"volatility_memory_0091","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract browser history from memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"cyberchef_decode_0089","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Deobfuscate this JavaScript payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For XOR, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"cyberchef_decode_0032","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode this URL encoded string."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0023","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the LDAP response time trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      271\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0038","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract archives from the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"strings_extraction_0033","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0070","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for lateral movement patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"volatility_memory_0008","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all processes in the memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0032","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the 504 responses on our web tier?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      544\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0035","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"otx_threat_lookup_0075","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up CVE information for CVE-2023-1234."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"strings_extraction_0093","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs in the executable."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"negative_limitation_explanation_0040","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"multi_tool_incident_response_0075","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the attack timeline from this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"xplico_reconstruction_0089","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0009","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a TLS security audit on our DMZ servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      202\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0058","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract the filesystem from the firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0031","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if the database latency is due to network issues or server processing."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      137\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0024","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Count occurrences of each unique IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0082","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a TLS security audit on our mail servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      305\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0045","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Calculate the packets per second rate."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0055","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the call failure rate in the last 1 hour?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      246\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0058","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the call failure rate in the last 1 hour?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      24\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0085","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DHCP servers with high NAK rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      349\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0015","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the error rate on our web servers for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      230\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0052","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for suspicious IP."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0064","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for network congestion indicators across the data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      },\n      {\n        \"name\": \"stall_out\"\n      }\n    ],\n    \"object_ids\": [\n      204\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0026","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all processes in the memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0107","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_http_errors_0063","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the top failing URIs on payment-api."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      916\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0099","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show UDP flows sorted by packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"strings_extraction_0092","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0092","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor call setup times for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      119\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0043","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      12\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0039","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show URLs for smtp packets only."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For HTTP hosts, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"splunk_search_0039","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for hash across all logs."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0034","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct FTP file transfers."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"otx_threat_lookup_0076","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 8.8.8.8."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"foremost_carving_0096","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve all recognizable files."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"xplico_reconstruction_0007","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct the user's browsing timeline."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"foremost_carving_0035","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve all recognizable files."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"strings_extraction_0016","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs in the executable."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"capinfos_metadata_0029","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the average packet size?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0044","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing high latency on the SQL Server server. What's causing it?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      775\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0004","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit certificate expiration across the production environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      404\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0000","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we experiencing packet loss between SEA and DFW?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      863\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0092","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0068","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct FTP file transfers."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0031","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show conversations to external IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"binwalk_firmware_0077","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0040","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze command and control activity."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_site_overview_0012","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Give me an overview of total TCP connections at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      324\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0037","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for IP address across all logs."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0055","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the current connection load across the network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      344\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0050","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the network slowdown? Check retransmits and zero windows."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      857\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0081","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0185","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"binwalk_firmware_0007","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the bootloader."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_field_extraction_0072","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all TLS SNI from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"splunk_search_0015","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of malware activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"strings_extraction_0036","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find command strings in the sample."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0208","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"multi_tool_incident_response_0071","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate this potential breach."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"binwalk_firmware_0036","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract kernel and rootfs."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0095","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS requests to suspicious domains."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      261\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0048","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor RTP stream quality for active calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      665\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0084","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert from Base64 to UTF-8."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0087","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan extracted files for malicious content."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_storage_ops_0094","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      589\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0037","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"extrahop_dns_analysis_0092","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze DNS traffic to identify potential tunneling."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      368\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0016","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify potential data exfiltration to suspicious destinations."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      865\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0058","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any IP allocation problems."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      10\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0033","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract chat messages from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"binwalk_firmware_0071","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0057","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The Redis is dragging. Need to identify the bottleneck."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      268\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0010","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find network connections in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"strings_extraction_0059","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"splunk_search_0066","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of malware activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"cyberchef_decode_0077","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode this hex encoded string."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For URL, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"negative_ethical_boundary_0179","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"multi_tool_malware_workflow_0056","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Execute the full forensic workflow on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_dhcp_health_0002","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check DHCP server health - are we seeing any NAK responses?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      120\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0042","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for brute force attempts against dc-primary."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      876\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0022","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with high retransmission rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      821\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0091","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all MAC addresses from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"strings_extraction_0062","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0034","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_ssl_audit_0089","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for self-signed certificates across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      440\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0063","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract embedded documents."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0061","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Deobfuscate this macro payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0046","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find traffic to known bad IPs across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      434\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0004","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the incident and identify the attack vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_ssl_audit_0021","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any servers still using TLS 1.0 or 1.1."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      476\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0046","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor inbound vs outbound connection ratios."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      316\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0010","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the firmware structure."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0017","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets triggering high-severity alerts."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0009","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which DNS response codes are we seeing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      37\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0008","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform post-incident forensic analysis."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"otx_threat_lookup_0085","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if suspicious IP is malicious."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"binwalk_firmware_0012","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded certificates in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0038","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for ssh errors or anomalies."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For telnet, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"tshark_field_extraction_0044","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract URLs and packet sizes together."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_voip_quality_0046","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      165\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0219","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"extrahop_slow_database_0038","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Database queries are timing out on db-cluster-node1. Can you check the metrics?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      899\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0041","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for suspicious imports patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"capinfos_metadata_0017","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the file size and packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"binwalk_firmware_0028","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration files."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0086","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for TCP flow stalls across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      731\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0082","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the error rate on our web servers for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      409\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0037","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor DHCP lease activity for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      358\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0015","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What DNS record types are being queried most frequently?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      31\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0032","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for rdp errors or anomalies."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0057","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for file hash."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_threat_detection_0051","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for C2 communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      22\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0075","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for outbound connections to malicious hosts."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      586\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0088","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if https://phishing.site/login is in any threat feeds."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0051","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor call setup times for the past 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      772\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0035","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform post-incident forensic analysis."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"tshark_protocol_filter_0025","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract ssh packets with specific flags."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For smtp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0026","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DNS query patterns for the last 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      663\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0076","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find smtp traffic between 172.16.0.50 and 10.0.0.254."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For kerberos, I'll use the filter 'kerberos' or more specific filters like 'kerberos.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0045","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Our SQL Server response times have degraded. What do the metrics show?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      180\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0000","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all POST data from HTTP traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"negative_terminology_correction_0044","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"cyberchef_decode_0052","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decompress this bzip2 data."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For HTML entities, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0019","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify conversations with high packet rates."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0030","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform incident response analysis on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_ssl_audit_0023","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for self-signed certificates across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      368\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0016","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the bootloader."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_http_errors_0040","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The payment-api is returning errors. Need to identify the problematic endpoints."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      306\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0008","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check DHCP server health - are we seeing any NAK responses?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      911\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0042","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for shellcode patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"suricata_ids_scan_0007","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets matching exploit rules."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0080","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the network slowdown? Check retransmits and zero windows."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      382\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0044","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      534\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0013","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit certificate expiration across the DMZ environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      158\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0064","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS requests to suspicious domains."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      139\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0086","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0062","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the 400 responses on our web tier?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      216\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0061","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the malware analysis pipeline."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"multi_tool_malware_workflow_0087","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run comprehensive analysis and generate a report."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"suricata_ids_scan_0084","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for lateral movement patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_http_errors_0014","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Break down HTTP errors by URI for auth-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      104\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0078","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for call setup delays on the FreePBX system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      784\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0085","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Break down HTTP errors by URI for user-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      361\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0011","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check NFS latency on Pure-array."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      475\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0011","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan extracted files for malicious content."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"multi_tool_incident_response_0073","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze command and control activity."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"negative_ethical_boundary_0169","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"extrahop_ldap_auth_0066","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find domain controllers with high auth failure rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      777\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0030","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email addresses from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0052","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this capture for malicious activity."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"volatility_memory_0038","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract command history."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0064","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware, extract files, and correlate with threat intel."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_voip_quality_0035","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor RTP stream quality for active calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      460\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0034","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the data rate of this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"foremost_carving_0000","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover files from slack space."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0035","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify zero window conditions on our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      121\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0005","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DHCP success rate on our servers?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      868\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0090","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the malware family for this sample."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"negative_limitation_explanation_0117","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"strings_extraction_0044","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0048","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DHCP transaction metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      927\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0059","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for self-signed certificates across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      907\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0098","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct the user's browsing timeline."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"tshark_field_extraction_0012","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all TLS SNI from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"tshark_protocol_filter_0036","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract rdp packets with specific flags."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"volatility_memory_0072","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify malicious processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0061","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor lease renewals on the voice VLAN."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      436\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0049","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze file server workload distribution."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      468\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0080","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which DNS response codes are we seeing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      740\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0056","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"tshark_protocol_filter_0024","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter the pcap to show only ssh packets."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For ftp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"extrahop_http_errors_0074","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the error rate on our web servers for the past 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      25\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0061","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all strings from this binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0053","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for unusual connection patterns at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      244\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0088","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check LDAP server health for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      652\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0009","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"negative_out_of_scope_0187","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"networkminer_extraction_0042","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0081","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare network RTT vs server processing time for db-master."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      172\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0072","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify all hosts and their operating systems."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0016","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the custom ruleset against this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"foremost_carving_0062","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract files from memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_voip_quality_0024","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any SIP errors or call failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      889\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0025","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor Active Directory authentication metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      522\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0009","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up CVE information for CVE-2021-44228."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"capinfos_metadata_0092","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the file size and packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"negative_limitation_explanation_0134","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"volatility_memory_0039","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all processes in the memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0014","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DNS query distribution across our network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      31\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0098","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We need to investigate HTTP errors on the web-frontend application."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      792\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0051","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which servers have certificate issues in the last 24 hours?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      576\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0079","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the network slowdown? Check retransmits and zero windows."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      852\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0079","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0044","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the longest-running TCP sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"cyberchef_decode_0063","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decompress this gzip data."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0013","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      729\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0095","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the DMZ segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      636\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0067","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Pull database performance metrics for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      718\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0070","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any LDAP authentication failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      407\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0050","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How many active TCP connections do we have?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      106\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0074","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0082","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email attachments from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0047","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check overall network connection health."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      176\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0014","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare read vs write throughput on our NAS."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      979\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0034","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the ET Open ruleset against this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"tshark_field_extraction_0053","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all MAC addresses from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"capinfos_metadata_0085","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the time range of this pcap?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"binwalk_firmware_0065","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0003","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"networkminer_extraction_0079","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all downloaded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0028","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Our SQL Server response times have degraded. What do the metrics show?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      191\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0074","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check storage I/O patterns for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      372\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0097","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for lateral movement indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"yara_malware_scan_0074","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the file for known malware signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"otx_threat_lookup_0061","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if http://evil.com/malware is in any threat feeds."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0064","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for self-signed certificates across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      72\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0040","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the first and last packet timestamp?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0046","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"foremost_carving_0026","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve all recognizable files."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"volatility_memory_0040","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find injected code in processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0066","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the network slowdown? Check retransmits and zero windows."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      52\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0054","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find servers using weak ciphers in our environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      150\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0011","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"extrahop_tcp_congestion_0069","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the network slowdown? Check retransmits and zero windows."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      875\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0080","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate this potential breach."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_slow_database_0055","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare network RTT vs server processing time for db-analytics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      900\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0022","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the malware analysis pipeline."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_site_overview_0033","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      871\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0064","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0026","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify zero window conditions on our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      173\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0059","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify compression algorithms used."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0098","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Database queries are timing out on db-cluster-node1. Can you check the metrics?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      184\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0096","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are there any storage errors or bottlenecks?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      856\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0007","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"binwalk_firmware_0076","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded certificates in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0050","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Database queries are timing out on db-replica-02. Can you check the metrics?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      571\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0037","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Parse this MessagePack structure."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For HTML entities, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0069","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a TLS security audit on our API servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      919\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0086","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show suspicious network activity from the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      424\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0073","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for smb traffic larger than 5000 bytes."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0055","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for network congestion indicators across the data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      256\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_limitation_explanation_0262","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"tshark_field_extraction_0017","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show ports sorted by frequency."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"cyberchef_decode_0003","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert from Base64 to binary."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0095","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for botnet indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_http_errors_0007","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 500 errors on the payment-api. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      348\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0091","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any SIP errors or call failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      503\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0049","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Execute the full forensic workflow on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"cyberchef_decode_0021","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this data using DES."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For XOR, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"binwalk_firmware_0046","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"negative_limitation_explanation_0146","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"negative_ethical_boundary_0123","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"multi_tool_incident_response_0058","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"otx_threat_lookup_0008","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for file hash."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"strings_extraction_0013","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0092","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run comprehensive analysis and generate a report."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_tcp_congestion_0024","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify congestion hotspots in the colo data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      626\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0037","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract registry keys from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0079","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me storage throughput metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      869\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0061","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for lateral movement patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0068","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How many active TCP connections do we have?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      265\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0012","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden images in the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"strings_extraction_0026","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0042","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find threat actors associated with suspicious IP."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0069","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      416\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0068","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the pcap for known attack signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"tshark_field_extraction_0034","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show ports for dns packets only."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"volatility_memory_0052","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"splunk_search_0031","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all events from server-prod."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0077","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the attack timeline from this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"capinfos_metadata_0099","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the data rate of this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0046","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DHCP success rate on our servers?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      209\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0061","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check SIP transaction health across our VoIP infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      903\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0051","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0099","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the file for known malware signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"negative_limitation_explanation_0010","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"binwalk_firmware_0081","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the firmware structure."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0028","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DHCP servers with high NAK rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      835\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0000","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0030","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Cobalt Strike indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_threat_detection_0043","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for C2 communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      239\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0137","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"multi_tool_malware_workflow_0057","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform threat hunting on this network capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_dns_analysis_0069","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DNS anomalies or suspicious queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      422\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0041","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify compression algorithms used."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0094","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Rebuild downloaded web pages."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"otx_threat_lookup_0090","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 192.168.1.1."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0052","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all kerberos traffic from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For smb, I'll use the filter 'smb' or more specific filters like 'smb.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0057","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the firmware structure."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_field_extraction_0007","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets where MAC addresses matches 192.168.*."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0032","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for self-signed certificates across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      861\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0087","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract DNS queries and responses."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0019","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Database queries are timing out on db-master. Can you check the metrics?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      184\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0172","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"volatility_memory_0001","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0009","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for lateral movement patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0090","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for smb traffic larger than 1000 bytes."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For ssh, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0061","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract the filesystem from the firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"foremost_carving_0017","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract files from memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"networkminer_extraction_0021","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify all hosts and their operating systems."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0001","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check storage I/O patterns for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      279\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0024","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all web forms submitted in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"negative_limitation_explanation_0061","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"networkminer_extraction_0043","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all HTTP file downloads."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0083","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan extracted files for malicious content."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0028","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find unusual DNS query patterns that might indicate exfiltration."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      885\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0032","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all processes in the memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_threat_detection_0039","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a threat intelligence check on our network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      456\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0021","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations involving 192.168.1.100."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0077","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DNS query distribution across our network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      928\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0016","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check NFS latency on Unity."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      936\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0046","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"networkminer_extraction_0065","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0048","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract kerberos packets with specific flags."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"splunk_search_0008","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find events matching error."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"splunk_search_0062","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find failed login attempts from 192.168.1.50."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"splunk_search_0012","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all events from dc-primary."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"cyberchef_decode_0019","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Deobfuscate this JavaScript payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0083","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find OTX pulses mentioning malware.net."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"splunk_search_0073","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of malware activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0049","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any SSL/TLS vulnerabilities on our infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      553\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0081","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for network congestion indicators across the data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      132\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0084","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which DNS response codes are we seeing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      586\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0031","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show https traffic in the last first 5 minutes of the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"negative_terminology_correction_0138","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"extrahop_ssl_audit_0007","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      199\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0080","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find OTX pulses mentioning c2server.xyz."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0198","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_storage_ops_0043","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze file server workload distribution."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      270\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0041","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware, extract files, and correlate with threat intel."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"negative_out_of_scope_0108","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"suricata_ids_scan_0099","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect any exploit attempts in the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"splunk_search_0061","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for domain across all logs."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0008","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Give me an overview of total TCP connections at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      3\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0089","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract ports and timestamps together."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"suricata_ids_scan_0048","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets triggering high-severity alerts."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_http_errors_0011","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"HTTP errors increased on the api-gateway in the last 5 minutes. What's happening?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      887\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0014","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the capture statistics."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0096","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor lease renewals on the IoT VLAN."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      65\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0056","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Count occurrences of each unique ports."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_voip_quality_0037","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any voice quality issues on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      983\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0054","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for cleartext credentials in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0018","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform incident response analysis on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"multi_tool_incident_response_0089","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"networkminer_extraction_0027","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all files transferred in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0013","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan extracted files for malicious content."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0068","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze and extract all artifacts from this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"tshark_conversation_analysis_0048","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all unique IP pairs in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0055","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify clients making excessive DNS queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      991\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0056","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve all recognizable files."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"tshark_field_extraction_0060","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DNS queries values that appear only once."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"negative_tool_recommendation_0076","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"networkminer_extraction_0064","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract SSL certificates from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0046","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze file server workload distribution."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      113\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0024","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract strings from this encoded blob."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0006","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Our PostgreSQL response times have degraded. What do the metrics show?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      100\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0021","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find OTX pulses mentioning c2server.xyz."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"networkminer_extraction_0053","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all downloaded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0042","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The MariaDB is dragging. Need to identify the bottleneck."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      99\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0079","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are getting 504 errors when accessing user-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      995\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0084","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      737\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0078","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 401 errors on the payment-api. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      126\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0000","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor Active Directory authentication metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      849\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0053","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any voice quality issues on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      431\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0018","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"volatility_memory_0049","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract command history."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"foremost_carving_0081","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract embedded documents."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"volatility_memory_0031","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract command history."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"splunk_search_0041","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate network and endpoint events."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0037","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract ftp packets with specific flags."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"extrahop_threat_detection_0087","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for C2 communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      269\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0058","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all HTTP file downloads."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0069","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"negative_ethical_boundary_0218","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"extrahop_voip_quality_0079","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      708\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0192","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"multi_tool_incident_response_0045","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform post-incident forensic analysis."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"tshark_conversation_analysis_0032","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all unique IP pairs in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"foremost_carving_0003","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract archives from the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"binwalk_firmware_0037","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"negative_limitation_explanation_0272","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_storage_ops_0086","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare read vs write throughput on our NAS."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      813\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0015","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Parse this MessagePack structure."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For ROT13, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0004","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify congestion hotspots in the colo data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      83\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0048","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the read/write ratio on our NAS storage?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      469\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0061","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      343\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0074","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate network and endpoint events."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0088","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect command and control traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0038","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_dns_analysis_0057","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DNS anomalies or suspicious queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      891\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0020","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if http://evil.com/malware is in any threat feeds."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0053","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DNS query patterns for the last 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      258\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0036","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the network slowdown? Check retransmits and zero windows."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      884\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0065","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract files from memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"negative_out_of_scope_0017","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"cyberchef_decode_0038","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this data using RC4."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0005","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for telnet errors or anomalies."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0082","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find OTX pulses mentioning evil.com."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0051","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for botnet indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0082","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all ftp traffic from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For ldap, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"networkminer_extraction_0097","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0070","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify zero window conditions on our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      488\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0073","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract strings from this encoded blob."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0049","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for telnet errors or anomalies."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"extrahop_threat_detection_0070","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      493\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0085","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show User-Agents for http packets only."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For HTTP hosts, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0045","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor lease renewals on the guest VLAN."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      379\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0058","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this capture for malicious activity."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"tshark_conversation_analysis_0002","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show conversations to external IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"cyberchef_decode_0075","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Deobfuscate this VBScript payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For hex, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"splunk_search_0050","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for authentication events in the last 7 days."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"tshark_field_extraction_0029","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find MAC addresses values that appear only once."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_threat_detection_0023","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      366\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0044","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform post-incident forensic analysis."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_dns_analysis_0088","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find unusual DNS query patterns that might indicate exfiltration."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      844\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0071","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0066","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform a full forensic analysis of the traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"tshark_field_extraction_0067","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all MAC addresses from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"otx_threat_lookup_0012","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 192.168.1.1."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0093","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a complete malware analysis on this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_ssl_audit_0062","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit certificate expiration across the DMZ environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      429\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0066","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      824\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0021","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0029","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the malware analysis pipeline."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"capinfos_metadata_0038","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the file size and packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"foremost_carving_0052","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract files from memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"negative_tool_recommendation_0050","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"multi_tool_malware_workflow_0051","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check this pcap for threats and extract IOCs."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_dns_analysis_0068","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for NXDOMAIN spikes in the last 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      966\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0069","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 1.2.3.4."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0234","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"extrahop_threat_detection_0009","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me any connections to suspicious hosts in the last 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      875\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0093","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"tshark_protocol_filter_0056","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract rdp packets from port 53."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For telnet, I'll use the filter 'telnet' or more specific filters like 'telnet.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"extrahop_http_errors_0030","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"HTTP errors increased on the user-service in the last 24 hours. What's happening?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      418\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0069","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the LDAP response time trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      121\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0055","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me servers with weak cipher suites."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      918\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0012","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which servers have certificate issues in the last 6 hours?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      190\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0043","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify malicious processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"cyberchef_decode_0088","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert from binary to hex."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0055","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if suspicious IP is malicious."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"strings_extraction_0028","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"yara_malware_scan_0037","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the file for known malware signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_threat_detection_0050","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for outbound connections to malicious hosts."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      181\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0087","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate this potential breach."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"negative_ethical_boundary_0227","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"negative_terminology_correction_0052","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"suricata_ids_scan_0081","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the pcap for known attack signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0068","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are complaining about slow SQL Server performance in the last 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      260\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0048","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find network connections in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0073","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check SIP transaction health across our VoIP infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      517\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0099","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the firmware structure."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0073","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for trojan indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0066","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor inbound vs outbound connection ratios."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      165\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0054","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Break down HTTP errors by URI for web-frontend."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      204\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0206","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"networkminer_extraction_0069","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for cleartext credentials in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0080","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      807\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0028","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      575\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0012","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all HTTP file downloads."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"negative_ethical_boundary_0168","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"suricata_ids_scan_0059","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"negative_tool_recommendation_0147","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"xplico_reconstruction_0047","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all web forms submitted in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"strings_extraction_0081","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract registry keys from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0033","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      201\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0022","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if this binary matches any YARA rules."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0079","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS requests to suspicious domains."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      328\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0064","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"extrahop_site_overview_0071","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show aggregate connection metrics for capacity planning."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      425\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0094","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Export User-Agents to CSV format."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"negative_terminology_correction_0236","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_threat_detection_0040","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for outbound connections to malicious hosts."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      15\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0012","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if this binary matches any YARA rules."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0038","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"volatility_memory_0022","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find injected code in processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0086","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Pull database performance metrics for the past 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      327\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0003","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any IP allocation problems."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      442\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0009","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate data exfiltration in this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"suricata_ids_scan_0078","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets matching web-attack rules."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0089","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check overall network connection health."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      244\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0060","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are getting 503 errors when accessing api-gateway."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      233\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0008","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run comprehensive analysis and generate a report."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_threat_detection_0071","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find traffic to known bad IPs across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      820\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0098","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode this ROT13 encoded string."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0072","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify LDAP performance issues."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      65\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0045","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter the pcap to show only smb packets."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For icmp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0010","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets where URLs matches *admin*."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_storage_ops_0017","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      610\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0021","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the malware family for this sample."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0074","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DHCP servers with high NAK rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      750\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0048","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      739\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0095","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct the user's browsing timeline."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_site_overview_0059","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor inbound vs outbound connection ratios."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      741\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0019","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate lateral movement in this traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"splunk_search_0057","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for domain across all logs."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"cyberchef_decode_0071","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert from decimal to binary."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0022","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if the database latency is due to network issues or server processing."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      598\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0040","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find failed login attempts from 10.0.0.100."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"negative_out_of_scope_0000","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"otx_threat_lookup_0050","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the reputation of abc123...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0013","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up CVE information for CVE-2021-44228."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0153","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"strings_extraction_0065","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract registry keys from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0014","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for brute force attempts against dc-replica."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      900\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0018","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for authentication bottlenecks on our LDAP servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      498\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0058","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find network connections in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0221","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"negative_ethical_boundary_0060","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"splunk_search_0038","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate events from IDS and Active Directory."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0002","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for call setup delays on the FreePBX system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      223\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0093","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any LDAP authentication failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      694\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0015","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Is the MariaDB slowdown caused by the application or network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      608\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0038","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      888\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0026","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show ftp traffic in the last first 5 minutes of the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For http, I'll use the filter 'http' or more specific filters like 'http.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0029","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations with the most retransmissions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0094","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for ssh traffic larger than 5000 bytes."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For ftp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0059","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for TCP flow stalls across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      810\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0094","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any LDAP authentication failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      436\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0001","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct the user's browsing timeline."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0043","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a complete malware analysis on this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_site_overview_0010","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      949\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0035","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Our PostgreSQL response times have degraded. What do the metrics show?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      316\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0018","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all events from server-prod."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0005","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"tshark_field_extraction_0068","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Count occurrences of each unique MAC addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"splunk_search_0048","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of breach activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"tshark_field_extraction_0042","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List unique TLS SNI values in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_voip_quality_0013","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      216\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0007","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract browser history from memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0032","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for suspicious IP."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"tshark_field_extraction_0097","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Count occurrences of each unique MAC addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For ports, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_slow_database_0037","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Database queries are timing out on db-replica-02. Can you check the metrics?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      484\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0096","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets matching scan rules."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"volatility_memory_0061","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"capinfos_metadata_0028","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How long is this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"splunk_search_0076","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find events matching failed."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"strings_extraction_0052","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs in the executable."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0047","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate lateral movement in this traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"foremost_carving_0090","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover pdf files from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"binwalk_firmware_0049","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0011","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze and extract all artifacts from this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"networkminer_extraction_0076","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"strings_extraction_0009","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find command strings in the sample."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0104","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"networkminer_extraction_0005","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all HTTP file downloads."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"strings_extraction_0056","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0080","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find flows with unusual port combinations."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0000","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor RTP stream quality for active calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      464\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0042","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show ssh traffic in the last last 10 minutes of the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For telnet, I'll use the filter 'telnet' or more specific filters like 'telnet.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"volatility_memory_0014","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List loaded DLLs for each process."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"negative_limitation_explanation_0171","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"cyberchef_decode_0031","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert from Base64 to binary."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For hex, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0076","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email communications from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"xplico_reconstruction_0048","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract VoIP call audio."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0000","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Deobfuscate this VBScript payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0018","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DNS anomalies or suspicious queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      313\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0032","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check DHCP server health - are we seeing any NAK responses?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      450\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0077","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Export User-Agents to CSV format."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0046","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find domain controllers with high auth failure rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      582\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0029","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What DNS record types are being queried most frequently?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      721\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0070","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for encoded or encrypted strings."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0007","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if malicious domain is malicious."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"networkminer_extraction_0018","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify all hosts and their operating systems."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0063","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"otx_threat_lookup_0023","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for suspicious IP."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"volatility_memory_0044","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find injected code in processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0063","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform threat hunting on this network capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"capinfos_metadata_0024","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Calculate the packets per second rate."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"splunk_search_0025","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all events from workstation-01."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0064","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any SIP errors or call failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      15\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0005","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which API endpoints are failing on user-service?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      917\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0021","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are complaining about slow Oracle performance in the last 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      549\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0091","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"extrahop_tcp_congestion_0008","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the edge segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      766\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0037","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find unusual DNS query patterns that might indicate exfiltration."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      832\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0011","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"splunk_search_0017","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of insider threat activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"volatility_memory_0002","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract command history."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"cyberchef_decode_0064","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Deobfuscate this macro payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0052","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if this binary matches any YARA rules."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_http_errors_0024","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are getting 401 errors when accessing user-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      423\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0083","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify conversations with high packet rates."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"negative_out_of_scope_0180","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"extrahop_ssl_audit_0044","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any servers still using TLS 1.0 or 1.1."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      312\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0014","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find OTX pulses mentioning evil.com."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0067","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0078","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a complete malware analysis on this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"strings_extraction_0007","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded file paths."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0086","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for NXDOMAIN spikes in the last 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      483\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0005","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0072","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      838\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0060","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      439\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0030","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the bootloader."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0035","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify obfuscation techniques in the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"networkminer_extraction_0061","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all downloaded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0074","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      385\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0003","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email attachments from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0029","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all files transferred in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0072","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Database queries are timing out on db-analytics. Can you check the metrics?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      184\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0065","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the network slowdown? Check retransmits and zero windows."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      148\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0039","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all strings from this binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0021","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze command and control activity."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"tshark_field_extraction_0035","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show URLs for http packets only."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For IP addresses, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"negative_limitation_explanation_0078","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_ldap_auth_0078","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor Active Directory authentication metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      685\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0038","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      698\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0000","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Pull database performance metrics for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      125\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0091","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How many packets are in this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"strings_extraction_0035","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration data from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0090","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor lease renewals on the corporate VLAN."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      330\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0032","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor inbound vs outbound connection ratios."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      669\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0087","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for authentication bottlenecks on our LDAP servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      378\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0035","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Break down HTTP errors by URI for user-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      577\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0076","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are complaining about slow MariaDB performance in the last 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      885\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0043","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if this binary matches any YARA rules."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"suricata_ids_scan_0052","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for RAT indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0059","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Cobalt Strike indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"negative_terminology_correction_0118","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"capinfos_metadata_0071","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the data rate of this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0085","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor total network throughput for the branch-west site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      600\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0072","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor NFS performance across our file servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      114\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0000","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform threat hunting on this network capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"networkminer_extraction_0047","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all downloaded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"capinfos_metadata_0060","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Calculate the packets per second rate."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0057","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the quality of our VoIP calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      723\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0131","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"binwalk_firmware_0038","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0026","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all HTTP file downloads."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0072","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for C2 communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      121\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0087","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find network connections in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0023","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show dns traffic in the last middle section of the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For smtp, I'll use the filter 'smtp' or more specific filters like 'smtp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"foremost_carving_0007","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover files from slack space."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"tshark_protocol_filter_0097","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find smb traffic between 10.0.0.1 and 8.8.8.8."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For rdp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"cyberchef_decode_0045","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract strings from this encoded blob."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For URL, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0073","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor DHCP lease activity for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      710\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0094","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Network seems slow. Check for congestion indicators."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      178\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0038","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration data from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0090","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show aggregate connection metrics for capacity planning."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      559\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0098","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DHCP servers with high NAK rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      887\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0064","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all dns requests to example.com."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For http, I'll use the filter 'http' or more specific filters like 'http.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0013","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How long is this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0018","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor lease renewals on the guest VLAN."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      688\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0087","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"negative_terminology_correction_0036","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"strings_extraction_0057","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all strings from this binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0027","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct the user's browsing timeline."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_storage_ops_0010","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are there any storage errors or bottlenecks?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      378\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0096","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this data using XOR."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0036","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0027","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all TCP conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"strings_extraction_0023","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"yara_malware_scan_0085","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the file for known malware signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"foremost_carving_0025","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover files from slack space."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0051","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert this hex dump to ASCII."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"capinfos_metadata_0011","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the first and last packet timestamp?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0064","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze command and control activity."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_dhcp_health_0051","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DHCP failures across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      908\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0036","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      139\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0050","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor Active Directory authentication metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      501\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0077","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me LDAP error rates across our domain controllers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      711\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0058","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the top failing URIs on auth-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      700\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0073","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Execute the full forensic workflow on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_storage_ops_0018","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      112\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0067","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check overall network connection health."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      543\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0074","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing high latency on the MongoDB server. What's causing it?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      518\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0031","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      357\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0024","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DHCP failures across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      226\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0090","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration files."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0053","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the encryption health of our web servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      55\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0082","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden images in the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0092","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check LDAP server health for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      251\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0093","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit certificate expiration across the development environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      637\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0002","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve files from this disk image."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"tshark_field_extraction_0006","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Export TLS SNI to CSV format."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For IP addresses, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0074","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find flows with unusual port combinations."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0032","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"splunk_search_0036","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for lateral movement indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0033","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract smtp packets from port 3389."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For icmp, I'll use the filter 'icmp' or more specific filters like 'icmp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"multi_tool_incident_response_0025","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the attack timeline from this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"multi_tool_incident_response_0028","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform post-incident forensic analysis."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"otx_threat_lookup_0081","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if suspicious IP is malicious."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"binwalk_firmware_0003","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration files."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0000","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 192.168.1.1."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0067","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Rebuild downloaded web pages."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"yara_malware_scan_0079","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if this binary matches any YARA rules."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"yara_malware_scan_0056","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Metasploit indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"binwalk_firmware_0078","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this firmware image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0072","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all dns traffic from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0087","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the average packet size?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"splunk_search_0020","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate events from firewall and DNS."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0067","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DNS query distribution across our network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      250\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0080","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a complete malware analysis on this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"tshark_protocol_filter_0007","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show http traffic in the last middle section of the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For rdp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"xplico_reconstruction_0031","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract VoIP call audio."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"multi_tool_incident_response_0000","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate this potential breach."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"networkminer_extraction_0001","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for cleartext credentials in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0042","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the management segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      },\n      {\n        \"name\": \"stall_out\"\n      }\n    ],\n    \"object_ids\": [\n      43\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0012","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded file paths."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0006","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check storage I/O patterns for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      310\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0084","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify LDAP performance issues."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      177\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0057","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for C2 communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      284\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0099","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a complete malware analysis on this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_threat_detection_0055","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show suspicious network activity from the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      828\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0030","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_http_errors_0080","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The user-service is returning errors. Need to identify the problematic endpoints."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      507\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0068","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any SIP errors or call failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      331\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0012","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email communications from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"otx_threat_lookup_0079","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up CVE information for CVE-2022-5678."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"negative_out_of_scope_0278","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"splunk_search_0054","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate events from firewall and Active Directory."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0089","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify clients making excessive DNS queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      594\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0053","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reverse the encoding on this payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For XOR, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"volatility_memory_0012","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract browser history from memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"yara_malware_scan_0001","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run malware classification on extracted files."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"xplico_reconstruction_0075","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email communications from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"capinfos_metadata_0067","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the capture statistics."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0095","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the encryption health of our web servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      461\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0025","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this capture for malicious activity."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"yara_malware_scan_0024","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Cobalt Strike indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"volatility_memory_0066","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0037","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for lateral movement patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0047","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze DNS traffic to identify potential tunneling."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      703\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0258","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"extrahop_dns_analysis_0045","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify clients making excessive DNS queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      916\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0044","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all events from workstation-01."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0001","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze and extract all artifacts from this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_slow_database_0013","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Database queries are timing out on db-master. Can you check the metrics?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      3\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0092","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare network RTT vs server processing time for db-replica-02."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      916\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0056","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all TCP conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0051","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Our Redis response times have degraded. What do the metrics show?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      494\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0062","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DHCP success rate on our servers?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      217\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0018","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find malware families associated with def456...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0036","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract chat messages from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0055","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert from Base64 to ASCII."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"splunk_search_0090","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for brute force indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0030","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run comprehensive analysis and generate a report."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"otx_threat_lookup_0047","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 1.2.3.4."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"volatility_memory_0093","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List loaded DLLs for each process."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0017","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show icmp traffic in the last last 10 minutes of the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For dns, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0028","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations involving 192.168.1.100."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0051","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for brute force attempts against DC01."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      901\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0001","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for process events in the last 7 days."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0076","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate this potential breach."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"multi_tool_incident_response_0072","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate lateral movement in this traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"tshark_protocol_filter_0018","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all smb traffic from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For icmp, I'll use the filter 'icmp' or more specific filters like 'icmp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"negative_tool_recommendation_0048","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"tshark_field_extraction_0005","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show URLs sorted by frequency."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For TLS SNI, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0088","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the network slowdown? Check retransmits and zero windows."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      439\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0098","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract rdp packets from port 445."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For ftp, I'll use the filter 'ftp' or more specific filters like 'ftp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"foremost_carving_0097","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover jpg files from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"networkminer_extraction_0024","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all HTTP file downloads."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0013","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the edge segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      975\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0078","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs in the executable."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0093","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter the pcap to show only telnet packets."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For ssh, I'll use the filter 'ssh' or more specific filters like 'ssh.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"extrahop_threat_detection_0056","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me any connections to suspicious hosts in the last 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      893\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0032","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract chat messages from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"foremost_carving_0069","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract files from memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0035","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What DNS record types are being queried most frequently?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      625\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0009","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"tshark_protocol_filter_0069","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all ssh conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For http, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"networkminer_extraction_0007","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract DNS queries and responses."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0005","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run malware classification on extracted files."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"capinfos_metadata_0088","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the time range of this pcap?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0052","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What DNS record types are being queried most frequently?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      549\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0048","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me servers with weak cipher suites."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      275\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0055","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0034","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations with the most retransmissions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0048","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the incident and identify the attack vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_ldap_auth_0024","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor bind operation latency on our directory servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      271\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0075","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all HTTP file downloads."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0050","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me storage throughput metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      308\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0042","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for outbound connections to malicious hosts."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      312\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_limitation_explanation_0071","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"volatility_memory_0050","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find registry hives in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_threat_detection_0094","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify potential data exfiltration to suspicious destinations."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      644\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0022","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract SSL certificates from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0012","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find https traffic between 192.168.1.100 and 10.0.0.254."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For https, I'll use the filter 'https' or more specific filters like 'https.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"networkminer_extraction_0086","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for sensitive data in cleartext."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0084","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0056","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the encryption health of our web servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      834\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0013","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract HTTP hosts from packets to 8.8.8.8."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_site_overview_0038","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor inbound vs outbound connection ratios."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      102\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0054","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find threat actors associated with malicious domain."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"strings_extraction_0054","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for encoded or encrypted strings."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_threat_detection_0034","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are any devices communicating with suspicious external IPs?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      698\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0089","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for sensitive data in cleartext."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0094","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware, extract files, and correlate with threat intel."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"cyberchef_decode_0007","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this data using DES."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0086","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How many active TCP connections do we have?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      105\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0080","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for smb traffic larger than 5000 bytes."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0083","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DNS query distribution across our network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      233\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0043","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reverse the encoding on this payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For hex, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0029","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all web forms submitted in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0068","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations with the most retransmissions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"yara_malware_scan_0055","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan extracted files for malicious content."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"volatility_memory_0079","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0051","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all http traffic from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For ssh, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"capinfos_metadata_0023","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0017","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for C2 communication patterns."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      700\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0077","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The PostgreSQL is dragging. Need to identify the bottleneck."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      105\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0023","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show ports for smtp packets only."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"capinfos_metadata_0063","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the time range of this pcap?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"tshark_field_extraction_0040","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show HTTP hosts sorted by frequency."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0010","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DNS query patterns for the last 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      343\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0081","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"extrahop_site_overview_0097","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      996\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0062","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      509\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0049","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for process events in the last 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0230","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"extrahop_site_overview_0041","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      186\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0023","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract command history."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0074","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the current connection load across the network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      50\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0080","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs values that appear only once."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_http_errors_0036","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"HTTP errors increased on the payment-api in the last 5 minutes. What's happening?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      471\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0061","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"networkminer_extraction_0071","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract DNS queries and responses."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0090","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      83\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0031","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"negative_terminology_correction_0030","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"negative_out_of_scope_0163","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"foremost_carving_0076","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract archives from the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"negative_limitation_explanation_0220","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"xplico_reconstruction_0092","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all web forms submitted in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0030","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What DNS record types are being queried most frequently?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      446\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_tool_recommendation_0070","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"splunk_search_0021","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find failed login attempts from external IP."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0001","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for brute force attempts against ad-server."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      85\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0014","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the encryption health of our web servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      194\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0075","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare network RTT vs server processing time for db-replica-02."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      77\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0063","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"strings_extraction_0072","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all strings from this binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0075","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DHCP servers with high NAK rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      800\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0020","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration data from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0053","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform a full forensic analysis of the traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_dns_analysis_0036","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find unusual DNS query patterns that might indicate exfiltration."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      415\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0032","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract registry keys from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0096","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract chat messages from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"negative_limitation_explanation_0209","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"splunk_search_0095","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find events matching denied."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"negative_out_of_scope_0058","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"extrahop_dns_analysis_0066","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DNS query distribution across our network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      694\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0025","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor DHCP lease activity for the past 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      380\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0086","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0014","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct the user's browsing timeline."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"binwalk_firmware_0039","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0097","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the encryption health of our web servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      502\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0086","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover zip files from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"otx_threat_lookup_0091","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 8.8.8.8."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0007","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor Active Directory authentication metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      213\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_tool_recommendation_0235","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"negative_out_of_scope_0047","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"extrahop_http_errors_0072","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The api-gateway is returning errors. Need to identify the problematic endpoints."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      527\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0003","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find domain controllers with high auth failure rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      41\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0030","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor bind operation latency on our directory servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      887\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0088","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any servers still using TLS 1.0 or 1.1."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      238\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0019","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0070","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for shellcode patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0071","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DNS query distribution across our network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      353\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0256","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"negative_terminology_correction_0079","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_threat_detection_0014","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      596\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0036","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate this potential breach."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"splunk_search_0003","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of breach activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0061","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify clients making excessive DNS queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      82\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0077","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the time range of this pcap?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0027","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a threat intelligence check on our network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      371\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0045","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check SIP transaction health across our VoIP infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      764\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0051","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate network and endpoint events."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0017","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the malware analysis pipeline."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"volatility_memory_0027","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find network connections in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"strings_extraction_0014","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded file paths."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0008","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets triggering high-severity alerts."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0027","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me servers with weak cipher suites."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      879\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0074","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert from Base64 to binary."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0047","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Database queries are timing out on db-master. Can you check the metrics?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      999\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0062","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all smtp traffic from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"extrahop_storage_ops_0012","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the read/write ratio on our NAS storage?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      379\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0044","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the data rate of this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"splunk_search_0019","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for authentication events in the last 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"networkminer_extraction_0099","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for cleartext credentials in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0112","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"extrahop_threat_detection_0068","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are any devices communicating with suspicious external IPs?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      361\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0196","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"extrahop_tcp_congestion_0054","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for TCP flow stalls across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      397\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0082","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the average packet size?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"splunk_search_0046","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find anomalous login patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0025","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      457\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0071","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find events matching error."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0010","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DHCP servers with high NAK rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      571\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0078","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve files from this disk image."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_voip_quality_0003","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any SIP errors or call failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      394\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0098","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for TCP flow stalls across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      400\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0022","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract the filesystem from the firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0046","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for sensitive data in cleartext."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"foremost_carving_0009","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden images in the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_http_errors_0094","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 404 errors on the user-service. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      701\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0099","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze DNS traffic to identify potential tunneling."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      959\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0081","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show conversations to external IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0015","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor RTP stream quality for active calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      836\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0000","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any SSL/TLS vulnerabilities on our infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      475\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0090","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for cleartext credentials in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0095","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify LDAP performance issues."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      287\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0049","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 503 errors on the payment-api. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      744\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0015","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze file server workload distribution."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      856\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0080","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor total network throughput for the cloud-region site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      450\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0059","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check SIP transaction health across our VoIP infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      797\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0061","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Break down HTTP errors by URI for auth-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      556\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0093","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up CVE information for CVE-2022-5678."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0045","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 192.168.1.1."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0096","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the incident and identify the attack vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_voip_quality_0056","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      364\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0072","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 8.8.8.8."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0057","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      551\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0069","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Count occurrences of each unique MAC addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"tshark_protocol_filter_0008","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract smtp packets from port 80."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For telnet, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0024","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me servers with weak cipher suites."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      68\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0083","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve files from this disk image."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"volatility_memory_0076","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0036","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find malware families associated with abc123...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"cyberchef_decode_0099","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert this hex dump to ASCII."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"cyberchef_decode_0010","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Parse this JSON structure."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0068","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all ldap traffic from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For rdp, I'll use the filter 'rdp' or more specific filters like 'rdp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0016","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for suspicious imports patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"multi_tool_incident_response_0051","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze command and control activity."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"yara_malware_scan_0061","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the malware family for this sample."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"negative_terminology_correction_0269","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_voip_quality_0034","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor call setup times for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      714\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0068","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Parse this MessagePack structure."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0271","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"binwalk_firmware_0013","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the firmware structure."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0043","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show conversations to external IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0022","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find servers using weak ciphers in our environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      118\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0083","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the bootloader."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"foremost_carving_0093","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract archives from the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0097","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What DNS record types are being queried most frequently?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      885\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0059","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      758\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0018","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if the database latency is due to network issues or server processing."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      454\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0093","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets where HTTP hosts matches 192.168.*."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0062","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me LDAP error rates across our domain controllers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      882\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0008","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify threat indicators in network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      634\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0041","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What DNS record types are being queried most frequently?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      506\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0029","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for authentication bottlenecks on our LDAP servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      924\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0036","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan extracted files for malicious content."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"splunk_search_0089","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for brute force indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0010","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct the user's browsing timeline."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0090","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform a full forensic analysis of the traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"tshark_protocol_filter_0060","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for dns traffic larger than 1000 bytes."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For ftp, I'll use the filter 'ftp' or more specific filters like 'ftp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"extrahop_threat_detection_0078","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      356\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0081","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate this potential breach."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"networkminer_extraction_0052","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for cleartext credentials in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0073","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS requests to suspicious domains."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      654\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0019","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract archives from the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"capinfos_metadata_0093","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the first and last packet timestamp?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0025","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if the database latency is due to network issues or server processing."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      451\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0043","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find unusual DNS query patterns that might indicate exfiltration."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      712\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0052","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract kernel and rootfs."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0012","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run comprehensive analysis and generate a report."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_threat_detection_0003","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me any connections to suspicious hosts in the last 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      591\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0086","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 403 errors on the web-frontend. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      293\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_tool_recommendation_0276","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"extrahop_http_errors_0089","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The payment-api is returning errors. Need to identify the problematic endpoints."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      867\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0024","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      711\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0247","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"tshark_conversation_analysis_0041","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all unique IP pairs in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0036","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DHCP servers with high NAK rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      523\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0070","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which servers have certificate issues in the last 6 hours?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      365\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0099","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all telnet requests to internal.corp."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"splunk_search_0092","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of insider threat activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0096","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Our Oracle response times have degraded. What do the metrics show?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      361\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0003","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract chat messages from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0020","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this data using RC4."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"negative_tool_recommendation_0054","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"extrahop_dhcp_health_0026","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DHCP failures across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      193\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0065","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"negative_tool_recommendation_0158","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"extrahop_voip_quality_0054","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for call setup delays on the Teams system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      270\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0061","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze file server workload distribution."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      686\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0045","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find traffic to known bad IPs across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      293\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0062","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze file server workload distribution."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      572\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0078","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How long is this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0077","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect command and control traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0062","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Database queries are timing out on db-analytics. Can you check the metrics?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      301\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0015","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show suspicious network activity from the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      361\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0081","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any voice quality issues on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      234\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0059","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate data exfiltration in this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"foremost_carving_0001","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden images in the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"strings_extraction_0053","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0150","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"xplico_reconstruction_0037","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"suricata_ids_scan_0063","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect command and control traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0029","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for encoded strings patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"suricata_ids_scan_0003","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect command and control traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"splunk_search_0059","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate network and endpoint events."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"cyberchef_decode_0062","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract strings from this encoded blob."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For HTML entities, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"strings_extraction_0049","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email addresses from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0068","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DHCP failures across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      626\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0014","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"tshark_protocol_filter_0084","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract icmp packets from port 53."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For rdp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"cyberchef_decode_0042","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Parse this MessagePack structure."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For XOR, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0074","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"yara_malware_scan_0092","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify obfuscation techniques in the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"tshark_protocol_filter_0006","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show https traffic in the last first 5 minutes of the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0019","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Export DNS queries to CSV format."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0092","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find servers using weak ciphers in our environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      346\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0090","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets triggering high-severity alerts."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0027","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify obfuscation techniques in the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"strings_extraction_0063","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs in the executable."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_threat_detection_0010","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify potential data exfiltration to suspicious destinations."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      544\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0052","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the 504 responses on our web tier?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      985\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0094","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for RAT indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"negative_ethical_boundary_0141","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"xplico_reconstruction_0060","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all web forms submitted in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"networkminer_extraction_0096","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify all hosts and their operating systems."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0047","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DHCP transaction metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      565\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_limitation_explanation_0240","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"foremost_carving_0039","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"tshark_protocol_filter_0061","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find dns traffic between 172.16.0.50 and 10.0.0.254."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For kerberos, I'll use the filter 'kerberos' or more specific filters like 'kerberos.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"extrahop_site_overview_0052","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Give me an overview of total TCP connections at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      352\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0017","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract command history."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"negative_out_of_scope_0065","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"capinfos_metadata_0053","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the capture statistics."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0074","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for malicious domain."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0006","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for file hash."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"strings_extraction_0031","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs in the executable."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0054","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find flows with unusual port combinations."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0069","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the error rate on our web servers for the past 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      953\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0013","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all web forms submitted in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"binwalk_firmware_0097","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0016","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any LDAP authentication failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      521\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0083","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      268\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0126","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"tshark_conversation_analysis_0052","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations involving 10.0.0.1."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0063","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check storage I/O patterns for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      912\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0065","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      901\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0069","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check this pcap for threats and extract IOCs."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"splunk_search_0030","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for exfiltration indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"networkminer_extraction_0049","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all HTTP file downloads."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0014","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with high retransmission rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      690\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0082","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Is the MariaDB slowdown caused by the application or network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      631\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0054","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me storage throughput metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      842\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0048","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this firmware image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0065","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the incident and identify the attack vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_http_errors_0046","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 503 errors on the web-frontend. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      522\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0054","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract the filesystem from the firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"splunk_search_0006","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate events from endpoint and proxy."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"strings_extraction_0021","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for encoded or encrypted strings."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0045","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_threat_detection_0080","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      472\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0014","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0053","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the attack timeline from this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"multi_tool_incident_response_0001","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate this potential breach."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_http_errors_0065","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The user-service is returning errors. Need to identify the problematic endpoints."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      783\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0012","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for brute force attempts against DC02."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      395\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0070","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform threat hunting on this network capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_storage_ops_0031","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor NFS performance across our file servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      363\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0005","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Pull database performance metrics for the past 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      929\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0063","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of insider threat activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0078","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze DNS traffic to identify potential tunneling."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      247\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0162","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"volatility_memory_0060","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0048","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DNS anomalies or suspicious queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      832\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0083","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the incident and identify the attack vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"volatility_memory_0088","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all processes in the memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0063","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check LDAP server health for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      766\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0000","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List loaded DLLs for each process."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"negative_limitation_explanation_0059","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"otx_threat_lookup_0038","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find related indicators for IP."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0031","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform threat hunting on this network capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"multi_tool_malware_workflow_0076","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware, extract files, and correlate with threat intel."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"negative_ethical_boundary_0217","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"extrahop_site_overview_0099","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor total network throughput for the branch-east site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      662\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0082","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Cobalt Strike indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"splunk_search_0024","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find anomalous login patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0016","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are getting 502 errors when accessing auth-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      706\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0028","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 500 errors on the payment-api. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      487\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0033","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any SSL/TLS vulnerabilities on our infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      389\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0119","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"otx_threat_lookup_0037","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find OTX pulses mentioning c2server.xyz."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_threat_detection_0028","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      733\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0062","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Rebuild downloaded web pages."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"negative_terminology_correction_0109","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"capinfos_metadata_0008","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the capture statistics."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0058","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What DNS record types are being queried most frequently?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      404\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0050","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration files."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"strings_extraction_0083","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for encoded or encrypted strings."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0030","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the reputation of ghi789...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"splunk_search_0069","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate network and endpoint events."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"negative_out_of_scope_0015","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"extrahop_ssl_audit_0090","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for self-signed certificates across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      1000\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0076","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all TCP conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0063","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DHCP failures across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      489\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0080","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DHCP success rate on our servers?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      723\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0062","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      400\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0043","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The web-frontend is returning errors. Need to identify the problematic endpoints."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      838\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0043","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded file paths."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"yara_malware_scan_0084","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Empire indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_threat_detection_0002","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify threat indicators in network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      225\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0079","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded file paths."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0051","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare read vs write throughput on our NAS."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      986\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0098","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find registry hives in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0013","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      746\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0014","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter the pcap to show only ssh packets."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For ssh, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"negative_ethical_boundary_0018","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"foremost_carving_0033","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract files from memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"strings_extraction_0006","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email addresses from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"negative_out_of_scope_0090","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"extrahop_voip_quality_0028","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any voice quality issues on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      920\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0097","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for botnet indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"binwalk_firmware_0080","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded certificates in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0025","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for TCP flow stalls across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      249\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0039","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the incident and identify the attack vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_ssl_audit_0006","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which servers have certificate issues in the last 24 hours?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      280\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0029","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode this URL encoded string."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"negative_limitation_explanation_0055","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"capinfos_metadata_0004","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the time range of this pcap?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0025","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all files transferred in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0003","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze and extract all artifacts from this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_slow_database_0017","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Database queries are timing out on db-cluster-node1. Can you check the metrics?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      834\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0046","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert this hex dump to ASCII."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"negative_ethical_boundary_0246","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"negative_out_of_scope_0039","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"extrahop_ssl_audit_0068","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find servers using weak ciphers in our environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      661\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0063","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all files transferred in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"volatility_memory_0069","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find injected code in processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0066","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any servers still using TLS 1.0 or 1.1."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      686\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0065","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing high latency on the MongoDB server. What's causing it?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      101\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0071","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me storage throughput metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      521\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0034","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0043","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Pull database performance metrics for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      790\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0068","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      407\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0040","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract SSL certificates from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_http_errors_0044","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the top failing URIs on auth-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      104\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0092","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform post-incident forensic analysis."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"suricata_ids_scan_0010","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets triggering high-severity alerts."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0058","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find domain controllers with high auth failure rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      659\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0098","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hardcoded credentials in firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_field_extraction_0052","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Export IP addresses to CSV format."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"tshark_protocol_filter_0021","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for https errors or anomalies."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For ftp, I'll use the filter 'ftp' or more specific filters like 'ftp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"extrahop_site_overview_0000","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show aggregate connection metrics for capacity planning."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      280\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0245","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"otx_threat_lookup_0004","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for malicious domain."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"strings_extraction_0071","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0034","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit certificate expiration across the development environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      402\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0091","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the error rate on our web servers for the past 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      321\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0002","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract registry keys from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0081","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the 403 responses on our web tier?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      157\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0056","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the bootloader."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0029","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for malicious domain."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0125","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_site_overview_0075","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor inbound vs outbound connection ratios."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      880\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0040","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS requests to suspicious domains."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      235\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0078","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify zero window conditions on our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      260\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0066","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for trojan indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"foremost_carving_0005","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover zip files from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"networkminer_extraction_0038","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract DNS queries and responses."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0027","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any voice quality issues on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      69\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0051","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all downloaded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0005","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Give me an overview of total TCP connections at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      627\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0242","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"strings_extraction_0087","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all strings from this binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0001","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show aggregate connection metrics for capacity planning."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      43\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0018","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze and extract all artifacts from this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"capinfos_metadata_0027","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the data rate of this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0060","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"negative_out_of_scope_0114","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"extrahop_ssl_audit_0016","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for self-signed certificates across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      295\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0068","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the reputation of ghi789...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"yara_malware_scan_0034","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan extracted files for malicious content."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_threat_detection_0083","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me any connections to suspicious hosts in the last 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      546\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0174","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"capinfos_metadata_0000","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the data rate of this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0085","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify clients making excessive DNS queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      874\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0155","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"tshark_field_extraction_0032","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Export DNS queries to CSV format."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_threat_detection_0062","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find traffic to known bad IPs across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      994\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0091","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we experiencing packet loss between DC1 and DFW?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      713\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0022","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Break down HTTP errors by URI for web-frontend."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      245\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0037","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check this pcap for threats and extract IOCs."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"xplico_reconstruction_0049","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email communications from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"networkminer_extraction_0048","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify all hosts and their operating systems."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0026","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Cobalt Strike indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"negative_ethical_boundary_0157","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"extrahop_ssl_audit_0052","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a TLS security audit on our DMZ servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      545\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0086","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the malware analysis pipeline."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_http_errors_0013","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The user-service is returning errors. Need to identify the problematic endpoints."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      107\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_tool_recommendation_0072","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"multi_tool_malware_workflow_0072","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the malware analysis pipeline."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_ssl_audit_0042","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find servers using weak ciphers in our environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      362\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0049","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the file size and packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"cyberchef_decode_0039","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert this hex dump to ASCII."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0054","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter the pcap to show only ssh packets."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For telnet, I'll use the filter 'telnet' or more specific filters like 'telnet.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"extrahop_voip_quality_0094","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check SIP transaction health across our VoIP infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      877\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0046","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if suspicious IP is malicious."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"networkminer_extraction_0004","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all files transferred in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"negative_out_of_scope_0099","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"extrahop_tcp_congestion_0019","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for network congestion indicators across the data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      123\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0050","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0047","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are there any storage errors or bottlenecks?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      191\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0062","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all HTTP hosts from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"yara_malware_scan_0054","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the signature-base rules against this file."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0093","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this data using XOR."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For ROT13, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0052","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a threat intelligence check on our network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      151\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0033","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a threat intelligence check on our network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      58\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0049","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show suspicious network activity from the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      357\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0091","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate network and endpoint events."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0072","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we experiencing packet loss between DC1 and SEA?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      600\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0037","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Break down HTTP errors by URI for auth-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      516\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0069","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Deobfuscate this JavaScript payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For ROT13, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_http_errors_0087","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the 403 responses on our web tier?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      64\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0020","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email communications from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0053","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find DHCP servers with high NAK rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      520\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0081","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      381\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0020","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for unusual connection patterns at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      492\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0028","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List unique HTTP hosts values in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For TLS SNI, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"binwalk_firmware_0060","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration files."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0143","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"tshark_field_extraction_0037","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets where IP addresses matches *.exe."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For TLS SNI, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"otx_threat_lookup_0077","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find OTX pulses mentioning malware.net."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0020","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for lateral movement patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0057","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all dns requests to example.com."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For smtp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0071","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for ftp errors or anomalies."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For dns, I'll use the filter 'dns' or more specific filters like 'dns.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"cyberchef_decode_0022","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode multiple layers of encoding."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For hex, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0000","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract ssh packets from port 445."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"xplico_reconstruction_0004","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"yara_malware_scan_0045","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"yara_malware_scan_0044","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the malware family for this sample."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_slow_database_0024","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Database queries are timing out on db-master. Can you check the metrics?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      65\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0026","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      839\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0052","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"foremost_carving_0077","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract embedded documents."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0098","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"volatility_memory_0024","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find injected code in processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0056","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      726\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0027","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for file hash."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0015","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all unique IP pairs in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"negative_limitation_explanation_0142","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_slow_database_0094","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Pull database performance metrics for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      516\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0064","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find events matching failed."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0007","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find flows with unusual port combinations."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_threat_detection_0081","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a threat intelligence check on our network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      944\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0096","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify congestion hotspots in the DR data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      },\n      {\n        \"name\": \"stall_out\"\n      }\n    ],\n    \"object_ids\": [\n      734\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0045","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware, extract files, and correlate with threat intel."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_tcp_congestion_0067","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for TCP flow stalls across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      147\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0050","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Break down HTTP errors by URI for web-frontend."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      878\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0076","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show User-Agents sorted by frequency."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For DNS queries, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"binwalk_firmware_0068","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0026","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform threat hunting on this network capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_tcp_congestion_0030","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with high retransmission rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      531\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0005","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0030","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me servers with weak cipher suites."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      248\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0038","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me LDAP error rates across our domain controllers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      295\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0099","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We need to investigate HTTP errors on the auth-service application."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      307\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0063","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations involving 192.168.1.100."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0076","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the storage segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      638\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0087","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Is the MongoDB slowdown caused by the application or network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      186\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0044","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for TCP flow stalls across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      342\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0010","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for sensitive data in cleartext."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0055","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all icmp traffic from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For ssh, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0057","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify LDAP performance issues."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      471\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0081","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor lease renewals on the guest VLAN."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      687\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0023","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The PostgreSQL is dragging. Need to identify the bottleneck."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      283\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0016","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for sensitive data in cleartext."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"volatility_memory_0056","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract command history."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"capinfos_metadata_0041","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0011","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me TCP retransmissions in the last 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      105\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0020","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if the database latency is due to network issues or server processing."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      64\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0070","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the reputation of abc123...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0073","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Rebuild downloaded web pages."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"capinfos_metadata_0059","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the file size and packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"negative_ethical_boundary_0178","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"extrahop_tcp_congestion_0093","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify congestion hotspots in the primary data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      71\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0080","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      469\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0001","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which servers have certificate issues in the last 7 days?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      471\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0088","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"capinfos_metadata_0084","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the time range of this pcap?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"negative_limitation_explanation_0002","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"negative_out_of_scope_0264","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"extrahop_site_overview_0087","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the current connection load across the network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      599\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0036","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show TLS SNI sorted by frequency."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For URLs, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"volatility_memory_0030","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find injected code in processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"splunk_search_0084","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find failed login attempts from 10.0.0.100."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0066","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Rebuild web browsing sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0099","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for brute force attempts against dc-replica."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      788\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0040","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The Redis is dragging. Need to identify the bottleneck."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      817\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_tool_recommendation_0062","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"tshark_protocol_filter_0092","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for smtp errors or anomalies."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"splunk_search_0035","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find events matching denied."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0078","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all unique IP pairs in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0032","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the read/write ratio on our NAS storage?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      221\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0055","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me LDAP error rates across our domain controllers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      339\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0029","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_http_errors_0019","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the 404 responses on our web tier?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      511\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0066","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor DHCP lease activity for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      798\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0050","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Cobalt Strike indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"strings_extraction_0000","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email addresses from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0042","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for call setup delays on the Zoom Phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      928\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0089","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any voice quality issues on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      702\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0091","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any SSL/TLS vulnerabilities on our infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      73\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_tool_recommendation_0261","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"multi_tool_malware_workflow_0020","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check this pcap for threats and extract IOCs."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"foremost_carving_0054","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract files from memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_site_overview_0037","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the TCP connection baseline for our site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      123\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0006","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify threat indicators in network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      472\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0002","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find failed login attempts from 10.0.0.100."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"tshark_field_extraction_0095","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Export MAC addresses to CSV format."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For HTTP hosts, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"capinfos_metadata_0047","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0043","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze command and control activity."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"cyberchef_decode_0070","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Parse this JSON structure."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0026","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find flows with unusual port combinations."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"yara_malware_scan_0093","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify obfuscation techniques in the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0071","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show conversations to external IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_voip_quality_0029","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      481\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0052","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the average packet size?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0035","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for unusual connection patterns at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      168\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0069","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are any devices communicating with suspicious external IPs?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      200\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0078","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Export DNS queries to CSV format."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For HTTP hosts, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0085","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for brute force attempts against ad-server."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      160\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0085","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find servers using weak ciphers in our environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      61\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0034","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DNS query patterns for the last 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      605\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0022","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all unique IP pairs in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"splunk_search_0087","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for domain across all logs."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"volatility_memory_0064","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find network connections in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_threat_detection_0000","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a threat intelligence check on our network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      887\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0050","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all telnet requests to example.com."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For https, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"extrahop_slow_database_0060","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing high latency on the MongoDB server. What's causing it?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      873\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0099","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the quality of our VoIP calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      747\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0085","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Deobfuscate this PowerShell payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For Base64, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0004","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check LDAP server health for the past 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      500\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0095","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's causing the 500 responses on our web tier?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      847\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0094","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all processes in the memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"strings_extraction_0073","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find command strings in the sample."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0031","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for authentication bottlenecks on our LDAP servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      454\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0214","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"extrahop_voip_quality_0044","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor RTP stream quality for active calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      455\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0042","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"tshark_conversation_analysis_0037","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify conversations with high packet rates."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0033","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 192.168.1.1."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"volatility_memory_0006","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify malicious processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0095","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"tshark_protocol_filter_0004","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find telnet traffic between 192.168.1.100 and 10.0.0.254."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For ftp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"networkminer_extraction_0060","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract DNS queries and responses."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0093","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show suspicious network activity from the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      943\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0058","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for network congestion indicators across the data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      643\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0003","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find threat actors associated with suspicious IP."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_threat_detection_0011","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify threat indicators in network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      755\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0031","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up CVE information for CVE-2021-44228."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0058","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all TCP conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0081","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare read vs write throughput on our NAS."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      513\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0043","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the core segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      136\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0011","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for cleartext credentials in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0031","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find traffic to known bad IPs across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      664\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0027","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"xplico_reconstruction_0028","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract chat messages from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0050","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all TCP conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0039","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up threat intelligence for 1.2.3.4."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0044","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all rdp requests to api.service.local."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For smtp, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0212","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"tshark_protocol_filter_0034","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract icmp packets with specific flags."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"extrahop_site_overview_0082","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check overall network connection health."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      117\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0082","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"strings_extraction_0060","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email addresses from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"strings_extraction_0042","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0015","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the incident and identify the attack vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"otx_threat_lookup_0095","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for malicious domain."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"cyberchef_decode_0012","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reverse the encoding on this payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0099","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      549\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0082","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify threat indicators in network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      468\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0194","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_ldap_auth_0009","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor bind operation latency on our directory servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      539\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0041","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      619\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0051","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover files from slack space."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0080","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for authentication bottlenecks on our LDAP servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      192\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0025","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify compression algorithms used."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0067","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the read/write ratio on our NAS storage?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      27\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0057","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"extrahop_slow_database_0073","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Is the SQL Server slowdown caused by the application or network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      41\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0020","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      413\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0130","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"extrahop_threat_detection_0074","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find traffic to known bad IPs across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      664\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0091","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0098","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a TLS security audit on our mail servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      178\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0094","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are there any DHCP pool exhaustion issues?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      134\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0103","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"binwalk_firmware_0073","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this firmware image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0083","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check storage I/O patterns for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      287\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0003","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for TCP flow stalls across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      253\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0018","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the bootloader."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"foremost_carving_0027","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve files from this disk image."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"binwalk_firmware_0053","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded certificates in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0095","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all ldap conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For ssh, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 1000\n  }\n}"}]}
{"id":"negative_limitation_explanation_0170","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_tcp_congestion_0082","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me TCP retransmissions in the last 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      495\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0034","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for sensitive data in cleartext."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0035","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check storage I/O patterns for the past 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      645\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0080","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all POST data from HTTP traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"suricata_ids_scan_0047","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect any exploit attempts in the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"cyberchef_decode_0080","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode this hex encoded string."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For URL, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"cyberchef_decode_0090","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert from Base64 to hex."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0056","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor DHCP lease activity for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      666\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0046","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze DNS traffic to identify potential tunneling."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      68\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0049","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"multi_tool_incident_response_0097","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the incident and identify the attack vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"otx_threat_lookup_0026","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up CVE information for CVE-2023-1234."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"strings_extraction_0022","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0009","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are there any DHCP pool exhaustion issues?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      250\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0201","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"multi_tool_incident_response_0034","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform incident response analysis on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_tcp_congestion_0031","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me TCP retransmissions in the last 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      705\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0035","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a threat intelligence check on our network traffic."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      785\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0034","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for brute force indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"Splunk searching uses SPL (Search Processing Language). I'll build a query with the search terms, add time constraints, and include any needed stats or table commands.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"negative_out_of_scope_0190","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"networkminer_extraction_0006","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0049","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Database queries are timing out on db-master. Can you check the metrics?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      25\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0002","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if the database latency is due to network issues or server processing."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      195\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0096","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the error rate on our web servers for the past 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      898\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0044","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the pcap for known attack signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0111","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"multi_tool_malware_workflow_0015","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Execute the full forensic workflow on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"negative_out_of_scope_0100","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"extrahop_storage_ops_0045","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      345\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0089","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Network seems slow. Check for congestion indicators."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      333\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0056","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the DMZ segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      }\n    ],\n    \"object_ids\": [\n      982\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_limitation_explanation_0267","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_voip_quality_0084","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the quality of our VoIP calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      106\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0003","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for unusual connection patterns at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      935\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0004","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert this hex dump to ASCII."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"negative_ethical_boundary_0006","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"xplico_reconstruction_0061","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract VoIP call audio."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_site_overview_0019","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor inbound vs outbound connection ratios."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      728\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0035","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which servers have certificate issues in the last 6 hours?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      682\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0095","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find devices with connections to threat-listed IPs."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      175\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0011","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show TLS SNI sorted by frequency."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"splunk_search_0086","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for IP address across all logs."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0061","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if the database latency is due to network issues or server processing."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      494\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0029","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the incident and identify the attack vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"volatility_memory_0011","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract command history."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0007","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a complete malware analysis on this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"tshark_field_extraction_0070","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Count occurrences of each unique MAC addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"negative_limitation_explanation_0200","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_storage_ops_0036","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Compare read vs write throughput on our NAS."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      290\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0061","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify congestion hotspots in the DR data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      150\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0097","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing a spike in 403 errors on the order-service. Which URIs are failing?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      876\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0032","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for suspicious imports patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_voip_quality_0096","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any SIP errors or call failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      140\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0029","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any servers still using TLS 1.0 or 1.1."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      83\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0002","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify clients making excessive DNS queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      913\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0042","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the firmware structure."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0034","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up CVE information for CVE-2022-5678."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"yara_malware_scan_0025","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"foremost_carving_0072","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Carve all recognizable files."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_http_errors_0047","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the error rate on our web servers for the past 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      765\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0089","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the average packet size?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0095","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find SIP endpoints with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      40\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0097","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify congestion hotspots in the colo data center."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      278\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0043","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0062","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate lateral movement in this traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"xplico_reconstruction_0038","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract chat messages from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"tshark_protocol_filter_0070","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter the pcap to show only ftp packets."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For icmp, I'll use the filter 'icmp' or more specific filters like 'icmp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0097","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for malware, extract files, and correlate with threat intel."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_http_errors_0042","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"HTTP errors increased on the order-service in the last 5 minutes. What's happening?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      291\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0066","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show URLs for smtp packets only."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"xplico_reconstruction_0072","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all web forms submitted in the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"otx_threat_lookup_0015","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the reputation of abc123...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"For threat intelligence, I query OTX with the indicator. The response includes reputation scores, associated pulses (threat reports), and related indicators for pivoting.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0034","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the top failing URIs on user-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      815\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0045","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any LDAP authentication failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      325\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0018","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify obfuscation techniques in the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"extrahop_site_overview_0009","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Give me an overview of total TCP connections at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      951\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0096","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show aggregate connection metrics for capacity planning."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      882\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0086","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check DHCP server health - are we seeing any NAK responses?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      286\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0009","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find any images in the network traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"The user wants to extract artifacts from network traffic. NetworkMiner can carve files, identify credentials, and extract DNS data. I'll enable the appropriate extraction options.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0064","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the Snort Community ruleset against this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_threat_detection_0085","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find traffic to known bad IPs across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      882\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0029","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify potential data exfiltration to suspicious destinations."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      950\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0018","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the capture statistics."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"tshark_field_extraction_0096","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Export HTTP hosts to CSV format."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"cyberchef_decode_0041","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract strings from this encoded blob."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For ROT13, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0091","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Incident response requires systematic analysis: 1) Scope the incident with metadata, 2) Identify attack patterns with IDS, 3) Extract artifacts for evidence, 4) Correlate with threat intel, 5) Build timeline.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"capinfos_metadata_0056","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the capture statistics."},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0004","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all TCP conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0026","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"HTTP errors increased on the web-frontend in the last 15 minutes. What's happening?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      139\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0005","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze and extract all artifacts from this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"tshark_conversation_analysis_0017","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations with the most retransmissions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_threat_detection_0079","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify potential data exfiltration to suspicious destinations."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      95\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0044","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DHCP failures across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      532\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0049","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for authentication bottlenecks on our LDAP servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      857\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0055","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      }\n    ],\n    \"object_ids\": [\n      373\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0189","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"extrahop_dns_analysis_0056","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify clients making excessive DNS queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      649\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0029","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this firmware image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0069","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the malware family for this sample."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"negative_limitation_explanation_0136","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"strings_extraction_0076","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for encoded or encrypted strings."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0053","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find domain controllers with high auth failure rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      249\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_tool_recommendation_0102","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"extrahop_http_errors_0020","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the error rate on our web servers for the past 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      434\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0034","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Execute the full forensic workflow on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_http_errors_0073","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me the top failing URIs on payment-api."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      493\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0033","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze the attack timeline from this pcap."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"networkminer_extraction_0013","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract SSL certificates from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0045","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations involving 172.16.0.50."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0001","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0045","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run a TLS security audit on our DMZ servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      921\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0062","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform threat hunting on this network capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"tshark_conversation_analysis_0096","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the longest-running TCP sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"volatility_memory_0035","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find network connections in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0017","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for unusual connection patterns at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      180\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0003","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing high latency on the Cassandra server. What's causing it?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      527\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0049","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for call setup delays on the Cisco UCM system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      19\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0041","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the backup segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      153\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0020","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any SSL/TLS vulnerabilities on our infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      968\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0115","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"capinfos_metadata_0075","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the time range of this pcap?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0050","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any SSL/TLS vulnerabilities on our infrastructure."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      708\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0037","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me any connections to suspicious hosts in the last 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      }\n    ],\n    \"object_ids\": [\n      131\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0019","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract DNS queries and responses."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"cyberchef_decode_0030","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decompress this zlib data."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For URL, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0011","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are complaining about slow Cassandra performance in the last 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      990\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_tool_recommendation_0166","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"suricata_ids_scan_0014","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the pcap for known attack signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0076","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      458\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0252","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"negative_ethical_boundary_0024","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"tshark_field_extraction_0000","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Export DNS queries to CSV format."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0079","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"binwalk_firmware_0032","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the bootloader."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"negative_ethical_boundary_0012","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"cyberchef_decode_0054","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Convert this hex dump to ASCII."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"otx_threat_lookup_0053","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the reputation of ghi789...."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0055","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"splunk_search_0081","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Generate a timeline of insider threat activity."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0067","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit certificate expiration across the development environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      202\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0048","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decompress this deflate data."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"volatility_memory_0067","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find network connections in memory."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"capinfos_metadata_0080","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0028","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract SSL certificates from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"strings_extraction_0048","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration data from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0029","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract rdp packets with specific flags."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For icmp, I'll use the filter 'icmp' or more specific filters like 'icmp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"binwalk_firmware_0006","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract the filesystem from the firmware."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0071","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect any exploit attempts in the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0065","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check DHCP server health - are we seeing any NAK responses?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      720\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0062","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration files."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0000","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find unusual DNS query patterns that might indicate exfiltration."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      995\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0055","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"String extraction reveals embedded text in binaries. For malware analysis, I look for URLs, IPs, registry keys, and API names. Setting minimum length helps filter noise.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_site_overview_0049","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor total network throughput for the DC1 site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      538\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0085","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all POST data from HTTP traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"splunk_search_0053","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for lateral movement indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"otx_threat_lookup_0049","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up CVE information for CVE-2022-5678."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0088","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      990\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0009","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct FTP file transfers."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"strings_extraction_0085","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract registry keys from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0041","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_dhcp_health_0041","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor DHCP lease activity for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      372\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0004","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor total network throughput for the branch-east site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      944\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0048","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets where IP addresses matches *admin*."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0054","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any LDAP authentication failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      772\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0025","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DNS query distribution across our network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      186\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0006","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor total network throughput for the DC1 site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      20\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_protocol_filter_0013","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all icmp conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"TShark display filters allow protocol-based extraction. The filter syntax is straightforward: use the protocol name, optionally combined with IP addresses, ports, or field-specific conditions.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"negative_ethical_boundary_0016","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"xplico_reconstruction_0079","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct the user's browsing timeline."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"splunk_search_0093","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate network and endpoint events."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"tshark_field_extraction_0009","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List unique IP addresses values in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"negative_tool_recommendation_0092","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"cyberchef_decode_0008","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decode multiple layers of encoding."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For URL, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0046","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all TCP conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0254","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"suricata_ids_scan_0015","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Detect any exploit attempts in the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"volatility_memory_0080","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract command history."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0049","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DNS query patterns for the last 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      164\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0056","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Deobfuscate this VBScript payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"splunk_search_0055","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find events matching malicious."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0038","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit certificate expiration across the production environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      375\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0090","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are complaining about slow PostgreSQL performance in the last 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      647\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0077","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all POST data from HTTP traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_voip_quality_0086","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any voice quality issues on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      671\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0075","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for ransomware indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0006","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all TCP conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0001","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for NXDOMAIN spikes in the last 15 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      230\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0075","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me TCP retransmissions in the last 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      733\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0001","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"tshark_protocol_filter_0039","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find smtp traffic between 192.168.1.100 and 10.0.0.254."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For icmp, I'll use the filter 'icmp' or more specific filters like 'icmp.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"negative_ethical_boundary_0203","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"otx_threat_lookup_0067","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for suspicious IP."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"negative_out_of_scope_0089","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"suricata_ids_scan_0035","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"negative_out_of_scope_0265","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"extrahop_ldap_auth_0043","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the LDAP response time trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      832\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_ethical_boundary_0229","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"multi_tool_incident_response_0027","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"binwalk_firmware_0002","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify compression algorithms used."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0042","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct the user's browsing timeline."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"xplico_reconstruction_0088","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Rebuild web browsing sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"negative_limitation_explanation_0068","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"capinfos_metadata_0006","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How long is this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"Capinfos provides quick statistics about pcap files. I'll enable the relevant output options for packet count, time range, and data rate.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0039","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the DMZ segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      }\n    ],\n    \"object_ids\": [\n      10\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0034","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden images in the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"foremost_carving_0070","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover deleted files from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0018","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me all TCP conversations in this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0024","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS requests to suspicious domains."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      }\n    ],\n    \"object_ids\": [\n      65\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0077","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"otx_threat_lookup_0071","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look up CVE information for CVE-2023-1234."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"OTX lookup requires identifying the indicator type (IP, domain, hash, URL, CVE) and querying the corresponding API endpoint. Results include reputation, pulses, and related IOCs.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0043","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit certificate expiration across the DMZ environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      },\n      {\n        \"name\": \"version\"\n      }\n    ],\n    \"object_ids\": [\n      282\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_incident_response_0054","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform incident response analysis on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"tshark_field_extraction_0081","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List unique DNS queries values in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For TLS SNI, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"cyberchef_decode_0076","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decompress this zlib data."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For HTML entities, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0035","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract chat messages from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"xplico_reconstruction_0093","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"tshark_field_extraction_0016","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS queries for http packets only."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_storage_ops_0095","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find storage volumes with high error rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      523\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_tool_recommendation_0270","playbook_id":"negative","playbook_name":"Negative: tool_recommendation","tool":"none","category":"tool_recommendation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Analyze this Word document for malware."},{"role":"assistant","content":"For document analysis, I recommend: 1) Use 'strings' to extract embedded text and URLs, 2) Use 'foremost' to carve any embedded files, 3) Use 'yara' with document-specific rules to detect malicious macros. Note that deep OLE/macro analysis may require specialized tools like oletools."}]}
{"id":"multi_tool_malware_workflow_0060","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the malware analysis pipeline."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_ldap_auth_0028","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for brute force attempts against dc-replica."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      143\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0097","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How long is this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0067","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify the longest-running TCP sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"strings_extraction_0089","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"tshark_field_extraction_0020","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Count occurrences of each unique IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_storage_ops_0091","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      143\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0084","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find flows with unusual port combinations."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0004","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Hack into the target system."},{"role":"assistant","content":"I cannot assist with unauthorized access to computer systems. This would be illegal and unethical. I can help with legitimate security testing, forensic analysis, or defensive security tasks."}]}
{"id":"strings_extraction_0015","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration data from the malware."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"foremost_carving_0029","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract archives from the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"xplico_reconstruction_0058","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct FTP file transfers."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Session reconstruction requires reassembling TCP streams and parsing application protocols. Xplico handles multiple protocols and outputs structured data.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0052","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we experiencing packet loss between DFW and SEA?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Network congestion is typically indicated by TCP-level metrics. Key indicators include: retransmissions (retx_out, retx_in) which show packet loss, and zero windows (zwnd_out, zwnd_in) which indicate buffer exhaustion. I'll use the 'tcp' category with 'device' object type to see device-level TCP health.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      604\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0019","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show suspicious network activity from the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      928\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0076","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me storage throughput metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      983\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0090","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate TCP performance issues on the backup segment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      },\n      {\n        \"name\": \"stall_out\"\n      }\n    ],\n    \"object_ids\": [\n      474\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0023","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DHCP transaction metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      488\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0025","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check storage I/O patterns for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      }\n    ],\n    \"object_ids\": [\n      164\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0030","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor lease renewals on the voice VLAN."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      831\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0067","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the LDAP response time trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      478\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0063","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DNS query distribution across our network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DNS analysis requires the dns category with application object type. Key metrics: record_type for query type distribution, rsp_code for response analysis, req_threat for suspicious domain queries.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      286\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0059","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find all HTTP file downloads."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"xplico_reconstruction_0043","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct FTP file transfers."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"tshark_field_extraction_0027","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List unique DNS queries values in the pcap."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For User-Agents, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0060","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations involving 8.8.8.8."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"splunk_search_0068","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all events from server-prod."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_http_errors_0001","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are getting 401 errors when accessing order-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      400\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0059","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"volatility_memory_0068","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract encryption keys."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0050","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor lease renewals on the guest VLAN."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To check DHCP health, I use dhcp_server category. The DORA process metrics (discover, offer, request, ack) plus nak for failures give a complete picture of IP allocation health.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      11\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0004","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List all processes in the memory dump."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"multi_tool_incident_response_0084","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform incident response analysis on this capture."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"For incident investigation, I chain tools to build a complete picture: TShark for traffic analysis, Suricata for attack detection, NetworkMiner for artifact extraction, and Splunk for log correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_voip_quality_0009","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor RTP stream quality for active calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      438\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0082","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the Snort Community ruleset against this capture."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"splunk_search_0079","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find failed login attempts from external IP."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_threat_detection_0018","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are any devices communicating with suspicious external IPs?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      207\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"xplico_reconstruction_0053","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Rebuild web browsing sessions."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"negative_limitation_explanation_0033","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"negative_limitation_explanation_0222","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_dhcp_health_0033","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for rogue DHCP servers on the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      524\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_voip_quality_0001","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the call failure rate in the last 6 hours?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"SIP/VoIP analysis uses the sip category at application level. Metrics: req/rsp for call volume, rsp_error for failures, tprocess for call setup time. This covers signaling health.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      132\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"suricata_ids_scan_0074","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the pcap for known attack signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0034","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me DHCP transaction metrics."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      523\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0040","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List the top talkers by bytes transferred."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"foremost_carving_0018","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden images in the data."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"cyberchef_decode_0060","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this data using RC4."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0015","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the DHCP success rate on our servers?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      }\n    ],\n    \"object_ids\": [\n      516\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0026","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded certificates in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"volatility_memory_0070","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract command history."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0043","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"The user wants IDS-based threat detection. Suricata will process the pcap against its ruleset and generate alerts in EVE JSON format. I'll configure it to use the appropriate rules path and enable fast pattern matching.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"networkminer_extraction_0078","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract email attachments from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0026","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check the quality of our VoIP calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      901\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0097","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this data using RC4."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0030","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets matching web-attack rules."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"For IDS scanning, I configure Suricata with the rules path and input pcap. The fast pattern option improves performance. Results include alert details, classification, and severity.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"strings_extraction_0001","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs in the executable."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"volatility_memory_0086","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify malicious processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0070","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What DNS record types are being queried most frequently?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to see DNS query distribution. For DNS metrics at the application level, I use 'dns' category with 'application' object type. The metric 'record_type' provides the breakdown of queries by DNS record type (A, AAAA, MX, etc.).\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      320\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0084","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any IP allocation problems."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      2\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0080","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing high latency on the Redis server. What's causing it?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      867\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"otx_threat_lookup_0024","playbook_id":"otx_threat_lookup","playbook_name":"OTX: Threat Intelligence Lookup","tool":"otx","category":"threat_intel","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Get the full pulse details for suspicious IP."},{"role":"assistant","content":"{\n  \"action\": \"run_otx\",\n  \"reasoning\": \"The user wants threat intelligence lookup. OTX provides reputation data, related indicators, and pulse information. I'll query the appropriate endpoint based on indicator type.\",\n  \"tool\": \"otx\",\n  \"config\": {\n    \"indicatorType\": \"ip\",\n    \"indicator\": \"\"\n  }\n}"}]}
{"id":"negative_ethical_boundary_0273","playbook_id":"negative","playbook_name":"Negative: ethical_boundary","tool":"none","category":"ethical_boundary","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Create malware to infect computers."},{"role":"assistant","content":"I cannot help create malware or other malicious software. I can assist with malware analysis for defensive purposes, understanding how malware works to better defend against it, or legitimate security research."}]}
{"id":"extrahop_slow_database_0093","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if the database latency is due to network issues or server processing."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      573\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0001","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"multi_tool_malware_workflow_0089","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check this pcap for threats and extract IOCs."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"The user wants comprehensive malware analysis. This requires multiple tools: TShark for filtering, Suricata for IDS, NetworkMiner for extraction, YARA for classification, and OTX for threat intel correlation.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_ssl_audit_0018","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit our internal servers for expired SSL certificates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Security hygiene check for TLS requires ssl_server category (API uses 'ssl' not 'tls'). Key metrics: expired_cert for certificate expiration, weak_cipher for outdated encryption, self_signed for untrusted certificates.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      526\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0073","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find hidden processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Memory analysis with Volatility uses plugins for specific artifacts. For process listing, I use pslist. For network connections, I use netscan. The profile must match the OS.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0029","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me TCP retransmissions in the last 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      912\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0011","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded executables."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_threat_detection_0032","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for outbound connections to malicious hosts."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      12\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"volatility_memory_0021","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"List loaded DLLs for each process."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"The user wants memory forensics. Volatility requires the correct memory profile and plugin selection. I'll configure the appropriate plugin for the requested analysis.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"negative_out_of_scope_0113","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the weather like today?"},{"role":"assistant","content":"I'm a network forensics assistant specialized in packet analysis, threat detection, and security investigations. I can't provide weather information, but I'd be happy to help with network security tasks like analyzing pcap files, investigating threats, or querying security metrics."}]}
{"id":"extrahop_site_overview_0031","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor total network throughput for the DC1 site."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Site-level TCP overview requires capture object type for aggregate metrics. Using tcp category with metrics: conn (total), established (active), conn_in (inbound). This gives site-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      564\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0098","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run comprehensive analysis and generate a report."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_slow_database_0053","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The Oracle is dragging. Need to identify the bottleneck."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a database performance investigation. The key metrics are: tprocess (server-side processing time) to identify if the DB is slow, rtt (round trip time) to check network latency, and error to see if queries are failing. Using db_server category for database server metrics.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      }\n    ],\n    \"object_ids\": [\n      313\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0022","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check NFS latency on Pure-array."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      531\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"foremost_carving_0066","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover jpg files from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"The user wants to carve files from binary data. Foremost identifies files by their headers and footers. I'll configure the file types to search for.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"extrahop_site_overview_0070","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Give me an overview of total TCP connections at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      }\n    ],\n    \"object_ids\": [\n      786\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0045","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the current connection load across the network?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      }\n    ],\n    \"object_ids\": [\n      520\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0044","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find embedded certificates in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0016","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing high latency on the MariaDB server. What's causing it?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      853\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0012","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DHCP failures across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants DHCP server health metrics, specifically NAK responses which indicate lease denials. For DHCP server metrics, I use 'dhcp_server' category. Key metrics include 'nak' for denied leases, 'ack' for successful leases, 'discover' and 'request' for client activity.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      708\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0006","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check LDAP server health for the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to check for LDAP authentication issues. For LDAP server metrics, I use 'ldap_server' category with 'device' object type. The relevant metrics are 'rsp_error' for failed responses and 'error' for general errors. I'll also include 'req' and 'rsp' to provide context on total authentication volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      425\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0084","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants site-wide TCP statistics. For site/appliance-level metrics, I use object_type 'capture'. The 'tcp' category at capture level provides aggregate connection statistics. Key metrics include 'conn' for total connections, 'established' for active connections, and 'conn_in' for inbound connections.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      }\n    ],\n    \"object_ids\": [\n      74\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_site_overview_0002","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show site-wide connection statistics for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      821\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0022","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check LDAP server health for the past 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"LDAP authentication monitoring uses ldap_server category with device object type. Key metrics: req/rsp for volume, rsp_error/error for failures, tprocess for latency.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      662\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_terminology_correction_0098","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Query the TLS metrics from the ExtraHop API."},{"role":"assistant","content":"I'll query TLS metrics for you. Note: The ExtraHop API uses 'ssl' as the category name, not 'tls'. I'll use metric_category 'ssl_server' or 'ssl_client' depending on whether you want server-side or client-side TLS metrics."}]}
{"id":"extrahop_http_errors_0017","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We need to investigate HTTP errors on the api-gateway application."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      994\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"splunk_search_0075","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for file events in the last 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0080","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for lateral movement patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"negative_terminology_correction_0204","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_storage_ops_0059","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor NFS performance across our file servers."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      901\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0096","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for encoded or encrypted strings."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"tshark_protocol_filter_0067","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract kerberos packets with specific flags."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Protocol filtering in TShark requires the correct display filter. For dns, the basic filter is just the protocol name. I can add qualifiers like src/dst IP, port numbers, or specific fields.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 500\n  }\n}"}]}
{"id":"extrahop_voip_quality_0052","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Monitor RTP stream quality for active calls."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      206\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0081","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run the custom rules against this file."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"The user wants YARA-based malware detection. I'll configure YARA with the appropriate rules file and scan the target. The output will show any matching rules with their metadata.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 30,\n    \"recursive\": false\n  }\n}"}]}
{"id":"foremost_carving_0040","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover jpg files from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"File carving with Foremost scans for magic bytes that indicate file boundaries. I'll enable the relevant file types or use 'all' for comprehensive recovery.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"negative_limitation_explanation_0277","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"cyberchef_decode_0057","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract strings from this encoded blob."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"The user wants to decode data. CyberChef can handle multiple encoding types and transformations. I'll build a recipe with the appropriate operations.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"multi_tool_incident_response_0063","playbook_id":"multi_tool_incident_response","playbook_name":"Multi-Tool: Incident Response Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Investigate the initial access vector."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"IR workflow: First understand the scope (capinfos), then detect malicious patterns (Suricata), extract evidence (NetworkMiner/Xplico), identify malware (YARA), and correlate across sources (Splunk).\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Scope the incident timeframe\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Identify suspicious conversations\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Detect attack patterns\"\n    },\n    {\n      \"tool\": \"xplico\",\n      \"purpose\": \"Reconstruct attacker sessions\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract transferred files\"\n    },\n    {\n      \"tool\": \"splunk\",\n      \"purpose\": \"Correlate with endpoint logs\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Identify threat actor TTPs\"\n    }\n  ]\n}"}]}
{"id":"extrahop_dns_analysis_0027","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DNS anomalies or suspicious queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"req_threat\"\n      }\n    ],\n    \"object_ids\": [\n      933\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"negative_out_of_scope_0213","playbook_id":"negative","playbook_name":"Negative: out_of_scope","tool":"none","category":"out_of_scope","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Write me a poem about cybersecurity."},{"role":"assistant","content":"While I appreciate creative requests, I'm optimized for technical network forensics tasks. I can help you analyze network traffic, investigate security incidents, or query ExtraHop metrics. Would you like help with any of those?"}]}
{"id":"tshark_field_extraction_0051","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find User-Agents values that appear only once."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0030","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show conversations to external IP addresses."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Conversation analysis in TShark uses the statistics mode. The -z conv,{protocol} option shows bidirectional flows with packet/byte counts for each direction.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"foremost_carving_0006","playbook_id":"foremost_carving","playbook_name":"Foremost: File Carving","tool":"foremost","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Recover jpg files from the binary."},{"role":"assistant","content":"{\n  \"action\": \"run_foremost\",\n  \"reasoning\": \"Foremost recovers files based on header/footer signatures. For targeted recovery, I specify file types. For broad recovery, I use 'all' mode.\",\n  \"tool\": \"foremost\",\n  \"config\": {\n    \"fileTypes\": \"all\",\n    \"verbose\": false\n  }\n}"}]}
{"id":"capinfos_metadata_0030","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the first and last packet timestamp?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_voip_quality_0006","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any SIP errors or call failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To assess VoIP quality, I need SIP metrics: req (call attempts), rsp_error (failures), tprocess (setup latency). Using sip category with application object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      306\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0075","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for self-signed certificates across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"This is a TLS security audit. Important: ExtraHop uses 'ssl' in the API even for TLS. I'll use ssl_server category with metrics: expired_cert, weak_cipher, self_signed. These identify the main certificate and encryption issues.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      }\n    ],\n    \"object_ids\": [\n      814\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0096","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract kernel and rootfs."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"yara_malware_scan_0095","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan the file for known malware signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 60,\n    \"recursive\": false\n  }\n}"}]}
{"id":"negative_limitation_explanation_0074","playbook_id":"negative","playbook_name":"Negative: limitation_explanation","tool":"none","category":"limitation_explanation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Decrypt this encrypted traffic."},{"role":"assistant","content":"Decrypting encrypted traffic requires the encryption keys. If you have the private key or session keys, TShark can decrypt TLS traffic with the appropriate configuration. Without keys, I can analyze the encrypted traffic metadata (certificate info, cipher suites, SNI) but cannot decrypt the payload."}]}
{"id":"extrahop_threat_detection_0059","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me any connections to suspicious hosts in the last 5 minutes."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      290\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0075","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Scan for Empire indicators."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"YARA scanning requires a rules file and target. I'll set an appropriate timeout and enable recursive scanning if needed for directories.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 300,\n    \"recursive\": false\n  }\n}"}]}
{"id":"binwalk_firmware_0084","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration files."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Firmware analysis with Binwalk identifies embedded components through signature matching. I'll enable extraction to pull out filesystems and other embedded data.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"extrahop_site_overview_0095","playbook_id":"extrahop_site_overview","playbook_name":"ExtraHop: Site-Wide TCP Overview","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Give me an overview of total TCP connections at the site level."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"For site-wide TCP stats, I use tcp category with capture object type. Metrics like conn, established, and conn_in provide the aggregate connection picture across the entire site.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"conn\"\n      },\n      {\n        \"name\": \"established\"\n      },\n      {\n        \"name\": \"conn_in\"\n      },\n      {\n        \"name\": \"threat_in\"\n      },\n      {\n        \"name\": \"threat_out\"\n      }\n    ],\n    \"object_ids\": [\n      945\n    ],\n    \"object_type\": \"capture\",\n    \"until\": 0\n  }\n}"}]}
{"id":"strings_extraction_0064","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find URLs in the executable."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"capinfos_metadata_0037","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the first and last packet timestamp?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"splunk_search_0082","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Correlate network and endpoint events."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"The user wants to search Splunk logs. I'll construct an SPL query with the appropriate search terms, time range, and any necessary transformations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0033","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"We're seeing high latency on the MariaDB server. What's causing it?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      517\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"networkminer_extraction_0091","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract DNS queries and responses."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"NetworkMiner performs passive analysis to extract files and metadata. I'll configure it to extract images, look for credentials, and parse DNS traffic.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0089","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show UDP flows sorted by packet count."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To analyze conversations, I use TShark's statistics features. The conv option groups packets into flows and provides summary statistics for each conversation.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"suricata_ids_scan_0000","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Run IDS analysis on this capture file."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"extrahop_slow_database_0030","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Pull database performance metrics for the past 1 hour."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      700\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0055","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find packets where TLS SNI matches 192.168.*."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"strings_extraction_0075","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for API function names."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The user wants to extract strings from a binary. I'll configure the minimum string length and encoding type based on the expected content.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_slow_database_0041","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"The MySQL is dragging. Need to identify the bottleneck."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Database latency can stem from network issues (high rtt) or server overload (high tprocess). I'll query both metrics along with error counts to provide a complete picture. Category is db_server with device object type.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      419\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0013","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Parse this JSON structure."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"Data decoding in CyberChef uses recipes - chains of operations. For ROT13, I'll use the corresponding decode operation, possibly chained with other transforms.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"tshark_field_extraction_0031","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all ports from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"Field extraction in TShark uses -T fields mode with -e to specify each field. Multiple -e options can extract multiple fields per packet.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_threat_detection_0022","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find traffic to known bad IPs across our network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find malicious connections, I use the net category's threat intelligence metrics: threat_connected for connection count, threat_bytes_out/in for data volume. Application object type gives network-wide visibility.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      }\n    ],\n    \"object_ids\": [\n      219\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0010","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"extrahop_tcp_congestion_0037","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for TCP flow stalls across the network."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"TCP congestion analysis requires looking at retransmission and window metrics. retx_out/retx_in show packet loss requiring retransmits. zwnd_out/zwnd_in indicate buffer full conditions. Using tcp category with device object type.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      },\n      {\n        \"name\": \"zwnd_in\"\n      },\n      {\n        \"name\": \"rto\"\n      }\n    ],\n    \"object_ids\": [\n      239\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0008","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which API endpoints are failing on web-frontend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"HTTP error investigation requires looking at response metrics. I'll use http_server_detail for URI-level breakdown. Key metrics: rsp (total responses), rsp_error (error responses). This helps identify which endpoints are problematic.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      522\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_slow_database_0056","playbook_id":"extrahop_slow_database","playbook_name":"ExtraHop: Slow Database Investigation","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check if the database latency is due to network issues or server processing."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user is asking about database latency. To diagnose whether the issue is network-related or server-related, I need to compare Round Trip Time (rtt) which measures network latency, with Server Processing Time (tprocess) which measures how long the server takes to process queries. I should also check for errors. The target is a database server, so I'll use metric_category 'db_server' with object_type 'device'.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"db_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"tprocess\"\n      },\n      {\n        \"name\": \"rtt\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      319\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0058","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the read/write ratio on our NAS storage?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Storage analysis uses nas category with application object type. Metrics: read/write for operation counts, read_bytes/write_bytes for throughput, error for failures.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-30m\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      136\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0046","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Audit certificate expiration across the production environment."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      }\n    ],\n    \"object_ids\": [\n      358\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0007","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are there any DHCP pool exhaustion issues?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-15m\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      },\n      {\n        \"name\": \"request\"\n      },\n      {\n        \"name\": \"ack\"\n      },\n      {\n        \"name\": \"nak\"\n      }\n    ],\n    \"object_ids\": [\n      420\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0042","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the data rate of this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"capinfos_metadata_0054","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the data rate of this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"volatility_memory_0019","playbook_id":"volatility_memory","playbook_name":"Volatility: Memory Forensics","tool":"volatility","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify malicious processes."},{"role":"assistant","content":"{\n  \"action\": \"run_volatility\",\n  \"reasoning\": \"Volatility extracts artifacts from memory dumps. Each analysis type requires a specific plugin. I'll set the profile based on the OS and select the appropriate plugin.\",\n  \"tool\": \"volatility\",\n  \"config\": {\n    \"profile\": \"\",\n    \"plugin\": \"pslist\"\n  }\n}"}]}
{"id":"negative_terminology_correction_0014","playbook_id":"negative","playbook_name":"Negative: terminology_correction","tool":"none","category":"terminology_correction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me SSL certificate issues."},{"role":"assistant","content":"I'll check for certificate issues. The ExtraHop API uses 'ssl_server' category for server-side TLS/SSL metrics. Key metrics include 'expired_cert' for expired certificates, 'self_signed' for self-signed certs, and 'weak_cipher' for weak encryption."}]}
{"id":"extrahop_voip_quality_0019","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for call setup delays on the FreePBX system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-5m\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      887\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0091","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are we seeing any LDAP authentication failures?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      217\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0036","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show suspicious network activity from the past 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify connections to known malicious hosts. ExtraHop's threat intelligence metrics track this. For network-level threat indicators, I use 'net' category with 'application' object type. The metric 'threat_connected' shows connections to suspicious IPs. I'll also include 'threat_bytes_out' and 'threat_bytes_in' to see data volume.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      },\n      {\n        \"name\": \"threat_bytes_in\"\n      },\n      {\n        \"name\": \"threat_pkts_out\"\n      },\n      {\n        \"name\": \"threat_pkts_in\"\n      }\n    ],\n    \"object_ids\": [\n      888\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"yara_malware_scan_0097","playbook_id":"yara_malware_scan","playbook_name":"YARA: Malware Pattern Matching","tool":"yara","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for packer signatures."},{"role":"assistant","content":"{\n  \"action\": \"run_yara\",\n  \"reasoning\": \"For malware identification, YARA matches byte patterns and strings against rules. The results include rule names, tags, and any metadata defined in matching rules.\",\n  \"tool\": \"yara\",\n  \"config\": {\n    \"rulesFile\": \"/opt/yara-rules/index.yar\",\n    \"timeout\": 120,\n    \"recursive\": false\n  }\n}"}]}
{"id":"tshark_field_extraction_0071","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract all MAC addresses from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For HTTP hosts, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"tshark_protocol_filter_0053","playbook_id":"tshark_protocol_filter","playbook_name":"TShark: Protocol Filtering","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Filter for telnet traffic larger than 1000 bytes."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to filter packets by protocol. TShark's display filter syntax uses protocol names directly. For https, I'll use the filter 'https' or more specific filters like 'https.request' for request packets only.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"{protocol}\",\n    \"outputFormat\": \"json\",\n    \"maxPackets\": 100\n  }\n}"}]}
{"id":"capinfos_metadata_0073","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What capture format is this file?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"The user wants pcap metadata. Capinfos extracts statistics like packet count, time range, and data rates without parsing individual packets.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"splunk_search_0067","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for network events in the last 24 hours."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"extrahop_ssl_audit_0081","playbook_id":"extrahop_ssl_audit","playbook_name":"ExtraHop: TLS Security Audit","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which servers have certificate issues in the last 1 hour?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to find servers with SSL/TLS security issues. Note that while the user says 'SSL', the ExtraHop API uses 'ssl' as the category name (not 'tls'). For server-side TLS metrics, I use 'ssl_server'. The metrics for security audit are: expired_cert (expired certificates), self_signed (self-signed certs), and weak_cipher (weak encryption).\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"ssl_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"expired_cert\"\n      },\n      {\n        \"name\": \"weak_cipher\"\n      },\n      {\n        \"name\": \"self_signed\"\n      },\n      {\n        \"name\": \"session\"\n      }\n    ],\n    \"object_ids\": [\n      677\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_field_extraction_0086","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show DNS queries for http packets only."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"To extract fields, I configure TShark with -T fields and -e {field_name}. The output can be formatted as text, CSV, or JSON for further processing.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"extrahop_voip_quality_0093","playbook_id":"extrahop_voip_quality","playbook_name":"ExtraHop: VoIP Quality Assessment","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me VoIP metrics for our phone system."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"VoIP quality is measured through SIP signaling metrics. For SIP, I'll use 'sip' category with 'application' object type. Key metrics include 'req' for requests, 'rsp_error' for failed calls, and 'tprocess' for setup latency.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"sip\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      }\n    ],\n    \"object_ids\": [\n      512\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0000","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract configuration files."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"The user wants firmware analysis. Binwalk scans for embedded files and filesystems. I'll enable extraction and signature scanning.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"splunk_search_0026","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find events matching denied."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"xplico_reconstruction_0002","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Reconstruct all HTTP sessions from the capture."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"The user wants session reconstruction. Xplico can reassemble application-layer data from packets. I'll enable file extraction and configure protocol-specific options.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_http_errors_0045","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Which API endpoints are failing on order-service?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants to identify which URIs are causing HTTP errors. Since they want a breakdown, I need to use the detail category 'http_server_detail' which provides URI-level granularity. The relevant metrics are 'rsp' for total responses and 'rsp_error' for error responses. Object type is 'device' since we're looking at a specific server.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      202\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_dhcp_health_0092","playbook_id":"extrahop_dhcp_health","playbook_name":"ExtraHop: DHCP Server Health","tool":"extrahop_api","category":"infrastructure","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify any IP allocation problems."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"DHCP health monitoring uses dhcp_server category with device object type. Metrics: discover/offer/request/ack for normal flow, nak for failures indicating pool exhaustion or config issues.\",\n  \"payload\": {\n    \"cycle\": \"30sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"dhcp_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"discover\"\n      },\n      {\n        \"name\": \"offer\"\n      }\n    ],\n    \"object_ids\": [\n      942\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"binwalk_firmware_0093","playbook_id":"binwalk_firmware","playbook_name":"Binwalk: Firmware Analysis","tool":"binwalk","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find encryption keys in the image."},{"role":"assistant","content":"{\n  \"action\": \"run_binwalk\",\n  \"reasoning\": \"Binwalk performs entropy analysis and signature scanning on firmware. For deep analysis, I enable recursive extraction to handle nested archives.\",\n  \"tool\": \"binwalk\",\n  \"config\": {\n    \"extract\": true,\n    \"matryoshka\": false,\n    \"signature\": true\n  }\n}"}]}
{"id":"splunk_search_0043","playbook_id":"splunk_search","playbook_name":"Splunk: Log Analysis","tool":"splunk","category":"correlation","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Search for registry events in the last 7 days."},{"role":"assistant","content":"{\n  \"action\": \"run_splunk\",\n  \"reasoning\": \"For log correlation in Splunk, I construct SPL queries that join or correlate events across sources. Time alignment and field extraction are key considerations.\",\n  \"tool\": \"splunk\",\n  \"config\": {\n    \"query\": \"search index=* {search_terms}\",\n    \"timeRange\": \"-24h\"\n  }\n}"}]}
{"id":"tshark_field_extraction_0099","playbook_id":"tshark_field_extraction","playbook_name":"TShark: Field Extraction","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract URLs from packets to internal servers."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants to extract specific fields. TShark's -T fields -e option allows extracting specific protocol fields. For TLS SNI, I'll use the appropriate field name like 'ip.src', 'http.host', or 'dns.qry.name'.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"csv\",\n    \"fields\": [\n      \"ip.src\",\n      \"ip.dst\",\n      \"tcp.port\"\n    ]\n  }\n}"}]}
{"id":"xplico_reconstruction_0063","playbook_id":"xplico_reconstruction","playbook_name":"Xplico: Session Reconstruction","tool":"xplico","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Extract chat messages from the traffic."},{"role":"assistant","content":"{\n  \"action\": \"run_xplico\",\n  \"reasoning\": \"Xplico performs deep protocol analysis to reconstruct sessions. For HTTP, it rebuilds pages and extracts files. For email, it reconstructs messages with attachments.\",\n  \"tool\": \"xplico\",\n  \"config\": {\n    \"extractFiles\": true,\n    \"extractEmails\": true,\n    \"extractVoIP\": false\n  }\n}"}]}
{"id":"extrahop_ldap_auth_0035","playbook_id":"extrahop_ldap_auth","playbook_name":"ExtraHop: LDAP Authentication Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find domain controllers with high auth failure rates."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze LDAP health, I use ldap_server category. Metrics include req (requests), rsp_error (auth failures), tprocess (response time). Device object type for server-level view.\",\n  \"payload\": {\n    \"cycle\": \"5min\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"ldap_server\",\n    \"metric_specs\": [\n      {\n        \"name\": \"req\"\n      },\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      },\n      {\n        \"name\": \"error\"\n      },\n      {\n        \"name\": \"tprocess\"\n      }\n    ],\n    \"object_ids\": [\n      95\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"capinfos_metadata_0058","playbook_id":"capinfos_metadata","playbook_name":"Capinfos: PCAP Metadata","tool":"capinfos","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"How many packets are in this capture?"},{"role":"assistant","content":"{\n  \"action\": \"run_capinfos\",\n  \"reasoning\": \"For pcap metadata, capinfos is the fastest tool. It reads file headers and provides statistics without full packet parsing.\",\n  \"tool\": \"capinfos\",\n  \"config\": {\n    \"showPacketCount\": true,\n    \"showTimeRange\": true,\n    \"showDataRate\": true\n  }\n}"}]}
{"id":"suricata_ids_scan_0092","playbook_id":"suricata_ids_scan","playbook_name":"Suricata: IDS Rule Matching","tool":"suricata","category":"detection","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for lateral movement patterns."},{"role":"assistant","content":"{\n  \"action\": \"run_suricata\",\n  \"reasoning\": \"Suricata IDS analysis requires running the pcap through the rule engine. The output will be EVE JSON format containing any alerts triggered by matching signatures.\",\n  \"tool\": \"suricata\",\n  \"config\": {\n    \"rulesPath\": \"/etc/suricata/rules\",\n    \"fastPattern\": true\n  }\n}"}]}
{"id":"strings_extraction_0099","playbook_id":"strings_extraction","playbook_name":"Strings: Text Extraction","tool":"strings","category":"extraction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Look for IP addresses in the file."},{"role":"assistant","content":"{\n  \"action\": \"run_strings\",\n  \"reasoning\": \"The strings tool extracts printable character sequences. I'll use both ASCII and Unicode modes to catch all embedded text, with an appropriate minimum length.\",\n  \"tool\": \"strings\",\n  \"config\": {\n    \"minLength\": 4,\n    \"encoding\": \"both\"\n  }\n}"}]}
{"id":"extrahop_dns_analysis_0054","playbook_id":"extrahop_dns_analysis","playbook_name":"ExtraHop: DNS Traffic Analysis","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check for DNS anomalies or suspicious queries."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze DNS patterns, I use dns category at the application level. Metrics like record_type show query distribution, rsp_code reveals errors, and req_threat identifies suspicious queries.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"dns\",\n    \"metric_specs\": [\n      {\n        \"name\": \"record_type\"\n      },\n      {\n        \"name\": \"rsp_code\"\n      },\n      {\n        \"name\": \"req\"\n      }\n    ],\n    \"object_ids\": [\n      172\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"cyberchef_decode_0001","playbook_id":"cyberchef_decode","playbook_name":"CyberChef: Data Decoding","tool":"cyberchef","category":"decode","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Deobfuscate this macro payload."},{"role":"assistant","content":"{\n  \"action\": \"run_cyberchef\",\n  \"reasoning\": \"CyberChef's auto-detect feature can identify encoding types. For known encodings, I'll specify the exact operations. For unknown, I'll enable auto-detection.\",\n  \"tool\": \"cyberchef\",\n  \"config\": {\n    \"recipe\": \"\",\n    \"autoDetect\": true\n  }\n}"}]}
{"id":"extrahop_storage_ops_0097","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are there any storage errors or bottlenecks?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"The user wants NAS storage operation metrics. For NAS/NFS metrics at the application level, I use 'nas' category with 'application' object type. Key metrics are 'read' for read operations, 'write' for write operations, and 'read_bytes'/'write_bytes' for data volume.\",\n  \"payload\": {\n    \"cycle\": \"auto\",\n    \"from\": \"-1h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      },\n      {\n        \"name\": \"error\"\n      }\n    ],\n    \"object_ids\": [\n      448\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0002","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform a full forensic analysis of the traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"A complete malware analysis workflow chains multiple tools: 1) Capinfos for metadata, 2) TShark for protocol analysis, 3) Suricata for IDS alerts, 4) NetworkMiner for file extraction, 5) YARA for malware classification, 6) OTX for IOC lookup.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"networkminer_extraction_0039","playbook_id":"networkminer_extraction","playbook_name":"NetworkMiner: File and Credential Extraction","tool":"networkminer","category":"reconstruction","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Identify all hosts and their operating systems."},{"role":"assistant","content":"{\n  \"action\": \"run_networkminer\",\n  \"reasoning\": \"For artifact extraction, NetworkMiner reassembles TCP streams and carves files based on magic bytes. It also identifies cleartext credentials and extracts metadata.\",\n  \"tool\": \"networkminer\",\n  \"config\": {\n    \"extractImages\": true,\n    \"extractCredentials\": true,\n    \"extractDNS\": true\n  }\n}"}]}
{"id":"multi_tool_malware_workflow_0036","playbook_id":"multi_tool_malware_workflow","playbook_name":"Multi-Tool: Malware Analysis Workflow","tool":"workflow","category":"workflow","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Perform a full forensic analysis of the traffic."},{"role":"assistant","content":"{\n  \"action\": \"execute_workflow\",\n  \"reasoning\": \"Comprehensive analysis requires a pipeline: triage with capinfos, detect with Suricata, extract with NetworkMiner, classify with YARA, and correlate with OTX. Each tool's output feeds the next stage.\",\n  \"workflow_steps\": [\n    {\n      \"tool\": \"capinfos\",\n      \"purpose\": \"Get capture metadata and statistics\"\n    },\n    {\n      \"tool\": \"tshark\",\n      \"purpose\": \"Filter and extract relevant traffic\"\n    },\n    {\n      \"tool\": \"suricata\",\n      \"purpose\": \"Run IDS rules for threat detection\"\n    },\n    {\n      \"tool\": \"networkminer\",\n      \"purpose\": \"Extract files and credentials\"\n    },\n    {\n      \"tool\": \"yara\",\n      \"purpose\": \"Classify extracted files for malware\"\n    },\n    {\n      \"tool\": \"otx\",\n      \"purpose\": \"Correlate IOCs with threat intelligence\"\n    }\n  ]\n}"}]}
{"id":"extrahop_tcp_congestion_0038","playbook_id":"extrahop_tcp_congestion","playbook_name":"ExtraHop: Network Congestion Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Show me TCP retransmissions in the last 6 hours."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To diagnose network congestion, I need TCP efficiency metrics: retransmissions (retx_out, retx_in) indicate packet loss, zero windows (zwnd_out, zwnd_in) show buffer exhaustion. Category is tcp with device object type.\",\n  \"payload\": {\n    \"cycle\": \"1hr\",\n    \"from\": \"-24h\",\n    \"metric_category\": \"tcp\",\n    \"metric_specs\": [\n      {\n        \"name\": \"retx_out\"\n      },\n      {\n        \"name\": \"retx_in\"\n      },\n      {\n        \"name\": \"zwnd_out\"\n      }\n    ],\n    \"object_ids\": [\n      305\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"tshark_conversation_analysis_0093","playbook_id":"tshark_conversation_analysis","playbook_name":"TShark: Conversation Analysis","tool":"tshark","category":"triage","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Find conversations involving 172.16.0.50."},{"role":"assistant","content":"{\n  \"action\": \"run_tshark\",\n  \"reasoning\": \"The user wants conversation-level analysis. TShark's -z conv option provides conversation statistics. I'll use -z conv,tcp for TCP conversations or -z conv,ip for IP-level flows.\",\n  \"tool\": \"tshark\",\n  \"config\": {\n    \"displayFilter\": \"\",\n    \"outputFormat\": \"text\",\n    \"statistics\": \"conv,tcp\"\n  }\n}"}]}
{"id":"extrahop_storage_ops_0064","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Check NFS latency on Unity."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-2h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      361\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_http_errors_0012","playbook_id":"extrahop_http_errors","playbook_name":"ExtraHop: Web Application Error Hunt","tool":"extrahop_api","category":"troubleshooting","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Users are getting 500 errors when accessing order-service."},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To find the source of HTTP errors, I need response metrics with URI breakdown. Using http_server_detail category with rsp and rsp_error metrics will show which endpoints are failing and at what rate.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-7d\",\n    \"metric_category\": \"http_server_detail\",\n    \"metric_specs\": [\n      {\n        \"name\": \"rsp\"\n      },\n      {\n        \"name\": \"rsp_error\"\n      }\n    ],\n    \"object_ids\": [\n      531\n    ],\n    \"object_type\": \"device\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_storage_ops_0085","playbook_id":"extrahop_storage_ops","playbook_name":"ExtraHop: Storage Operations Analysis","tool":"extrahop_api","category":"performance","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"What's the storage utilization trend?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"To analyze storage I/O, I use the nas category. Key metrics: read/write (operation counts), read_bytes/write_bytes (data volume). Application object type for aggregate view.\",\n  \"payload\": {\n    \"cycle\": \"1sec\",\n    \"from\": \"-6h\",\n    \"metric_category\": \"nas\",\n    \"metric_specs\": [\n      {\n        \"name\": \"read\"\n      },\n      {\n        \"name\": \"write\"\n      },\n      {\n        \"name\": \"read_bytes\"\n      },\n      {\n        \"name\": \"write_bytes\"\n      }\n    ],\n    \"object_ids\": [\n      110\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
{"id":"extrahop_threat_detection_0007","playbook_id":"extrahop_threat_detection","playbook_name":"ExtraHop: Threat Intelligence Correlation","tool":"extrahop_api","category":"security","messages":[{"role":"system","content":"You are a network forensics assistant specialized in packet analysis, threat detection, and security investigations. You help analysts investigate network traffic, query security metrics, and run forensic tools. Always explain your reasoning before taking action."},{"role":"user","content":"Are any devices communicating with suspicious external IPs?"},{"role":"assistant","content":"{\n  \"action\": \"query_extrahop_metrics\",\n  \"reasoning\": \"Threat detection requires network-level metrics with threat intelligence. Using net category with application object type. Key metrics: threat_connected (suspicious connections), threat_bytes_out/in (data volume to/from bad IPs).\",\n  \"payload\": {\n    \"cycle\": \"24hr\",\n    \"from\": \"-12h\",\n    \"metric_category\": \"net\",\n    \"metric_specs\": [\n      {\n        \"name\": \"threat_connected\"\n      },\n      {\n        \"name\": \"threat_bytes_out\"\n      }\n    ],\n    \"object_ids\": [\n      926\n    ],\n    \"object_type\": \"application\",\n    \"until\": 0\n  }\n}"}]}
