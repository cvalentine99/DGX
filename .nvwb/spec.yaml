specVersion: v2
meta:
  name: nemo-command-center
  image: project-nemo-command-center
  description: Valentine RF Command Center for NVIDIA DGX Spark infrastructure management
  labels:
    - nvidia
    - dgx
    - nemo
    - ai
    - mlops
  createdOn: "2024-12-21"
  defaultBranch: main

layout:
  - path: code/
    type: code
    storage: git
  - path: data/
    type: data
    storage: gitlfs
  - path: models/
    type: models
    storage: gitlfs

container:
  image: nvcr.io/nvidia/pytorch:24.10-py3
  buildtime: docker
  runtime: docker

execution:
  apps:
    - name: NeMo Command Center
      type: custom
      class: webapp
      start: pnpm start
      health: /api/health
      port: "3000"
      icon: https://raw.githubusercontent.com/NVIDIA/NeMo/main/docs/source/_static/nemo_logo.png
      url: http://localhost:3000
      
    - name: JupyterLab
      type: jupyterlab
      class: webapp
      start: jupyter lab --allow-root --ip=0.0.0.0 --port=8888 --no-browser --NotebookApp.token='' --NotebookApp.password=''
      health: /api
      port: "8888"
      icon: https://upload.wikimedia.org/wikipedia/commons/3/38/Jupyter_logo.svg
      url: http://localhost:8888

  resources:
    gpu:
      requested: 1
    secrets:
      - variable: NGC_API_KEY
        description: NGC API Key for accessing NVIDIA containers and models
      - variable: HUGGINGFACE_TOKEN
        description: HuggingFace token for model downloads
      - variable: VLLM_API_KEY
        description: vLLM API key for inference server
      - variable: VLLM_API_URL
        description: vLLM API endpoint URL

  mounts:
    - type: project
      target: /project
      description: Project files
    - type: host
      target: /data
      source: ~/nvwb/data
      description: Shared data directory
    - type: host
      target: /models
      source: ~/nvwb/models
      description: Model storage

environment:
  variables:
    NODE_ENV: production
    DATABASE_URL: file:/project/data/nemo.db
    JWT_SECRET: ${JWT_SECRET}
    VITE_APP_TITLE: Valentine RF Command Center
